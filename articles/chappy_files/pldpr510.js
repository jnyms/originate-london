window.NOLCMB.registerLib("PLDPR",function($){"use strict";var PLDPR=$.PLDPR=$.PLDPR||{},ns=window.NOLCMB,sdkVersion="bj.5.0.0",_legacyBaseBuildVer="5.0.0",_localBuildVer="44",BUILDVERSION=$.getBaseBuildVer?$.getBaseBuildVer()+_localBuildVer:_legacyBaseBuildVer+_localBuildVer,dp="cgi-bin/",au=ns.getConfigAddress(),dprConfigAPI="cfg",dprErrorAPI="error",gIframe=$.getLS(),configVersion=$.getConfigVer(),defaultTimelineSize=5,functionMap={"[":{end:"]",count:0},"{":{end:"}",count:0},"<":{end:/\.\d+,\d+\>/g,count:0}},configRegex={bc:/\|\![\w\W]*?(\!\|)/g,length:2},cmsMapRegex=/[\[\{<\(\}\]>\)]/g,R={},timeOffset=0,currentRetry=0,maxRetry=5,errorWait=5,sendQueue=[],sendInterval,lsRetryMax=2,sending=false,sendQueue2=[],debugDisabledVal="false",debug=debugDisabledVal,configAddr,cmsMap={},l_eventFilter={},l_serviceFilter={},WEBSTORAGE=false,USEBEACON=false,bA,sender={send:function(oArg,l_pingServerTime){var arg=oArg,l_url=(arg.url.indexOf("&c62=")!==-1)?(removeParam(arg.url,"c62=")+"&c62=sendTime,"+((typeof l_pingServerTime!=='undefined')?l_pingServerTime:(getTIme()/1000>>0))):arg.url,self=this,sendURL=removeParam(l_url,"rnd=")+"&rnd="+Math.round(Math.random()*1000000),img=(!USEBEACON)?new Image():{onerror:{},onload:{}};img.onerror=function(dN){self.onError(dN,arg);};img.onload=function(dN){};if($.postMsgAvail&&arg.hasOwnProperty("maskRefUrl")&&arg.maskRefUrl!==-1&&arg.maskRefUrl==="true"){gIframe.contentWindow.postMessage(JSON.stringify({eventType:"maskref",data:{url:sendURL}}),gIframe.src);}else{(!USEBEACON)?img.src=sendURL:navigator.sendBeacon(sendURL);}},setup:function(oArgs){var self=this,l_url=oArgs.hasOwnProperty("url")?oArgs.url:"";var params=oArgs.params||{url:l_url,errorDelay:((oArgs.delay||errorWait)*1000),retry:0,maskRefUrl:(oArgs.hasOwnProperty("maskRefUrl")&&String(oArgs.maskRefUrl).length>0)?oArgs.maskRefUrl:-1};if(l_url&&l_url.length>0){self.send(params,oArgs.pingSendTime);}},onError:function(eEvt,oArg){var self=this,l_url=eEvt.target.src;if(oArg&&oArg.retry<maxRetry&&l_url&&l_url.length>0){oArg.retry+=1;oArg.url=l_url;window.setTimeout(function(){self.send(oArg);},oArg.errorDelay);}}},getTIme=ns.getTIme||function(){return(new Date()).getTime();},_errorSent={};var _eventDataController=(function(){var _key='nol_eventData',_delimiterKey='nol_eventDataDelimiter',_eventsKey='nol_eventDataEvents',_enabledKey='nol_eventDataEnabled',_valueDelimiter=':',_cache={delimiter:'',eventsList:[]},_eventDictionary=(function(){var _events={play:{name:'play',abbrv:'PL'},pause:{name:'pause',abbrv:'PU'},rewind:{name:'rewind',abbrv:'RW'},forward:{name:'forward',abbrv:'FW'},stop:{name:'stop',abbrv:'ST'},resume:{name:'resume',abbrv:'RE'},mute:{name:'mute',abbrv:'MT'}};return _events;})();var _controller={get:function(fData,vidType){var val='';if(fData){val=Data({data:fData,param:_key,vidType:(vidType||fData._currVidType)});}
return val;},set:function(fData,value,vidType){if(fData){Data({data:fData,param:_key,val:value,vidType:(vidType||fData._currVidType)});}
return fData;},clear:function(fData){if(fData){Data({data:fData,param:_key,val:'',vidType:'ad'});Data({data:fData,param:_key,val:'',vidType:'content'});}},clone:function(fData){try{return{content:_controller.get(fData,'content'),ad:_controller.get(fData,'ad')};}catch(e){return null;}},bind:function(fData,data){try{if(fData&&data){for(var type in data){_controller.set(fData,data[type],type);}}}catch(e){}},append:function(fData,eventObj){if(fData&&eventObj){var evtData=_controller.get(fData);var delimeter=_controller.delimiter(fData);var eventVal=_controller.parseEventData(eventObj);_controller.set(fData,evtData?[evtData,eventVal].join(delimeter):eventVal);}},delimiter:function(fData){if(fData){if(!_cache.delimiter){_cache.delimiter=Data({data:fData,param:_delimiterKey});}
return _cache.delimiter;}
return'';},isEnabled:function(fData){if(fData){return Data({data:fData,param:_enabledKey})==='true';}
return false;},isEventEnabled:function(eventName,fData){if(fData&&eventName){var event=_controller.lookupEvent(eventName.toLowerCase());if(event){return _controller.eventsList(fData).indexOf(event.name)>-1;}}
return false;},eventsList:function(fData){if(fData){if(!_cache.eventsList||_cache.eventsList.length==0){var list=Data({data:fData,param:_eventsKey});if(list){_cache.eventsList=list.split(',');}}
return _cache.eventsList;}},clearCache:function(){_cache.delimiter='';_cache.eventsList=[];},lookupEvent:function(eventName){if(eventName){return _eventDictionary[eventName.toLowerCase()];}
return null;},parseEventData:function(eventObj){var eventData='';if(eventObj){var event=_controller.lookupEvent(eventObj.event);if(event){var arr=[event.abbrv,eventObj.timestamp,eventObj.curPos];if(eventObj.prevPos!==undefined&&eventObj.prevPos!==null&&eventObj.curPos!=eventObj.prevPos){arr.push(eventObj.prevPos);}
if(eventObj.p1!==undefined&&eventObj.p1!==null){arr.push(eventObj.p1);}
eventData=arr.join(_valueDelimiter);}}
return eventData;},handleEvent:function(fData,eventData){if(fData&&eventData){if(_controller.isEventEnabled(eventData.event,fData)){_controller.append(fData,eventData);}}},setNextTick:function(fData,eventData,vidType){var eventString=_controller.get(fData,vidType);if(eventString&&eventString.indexOf('{{nextTick}}')>-1){if(eventData&&eventData.event===_eventsController.events.playhead){fData=_controller.set(fData,eventString.replace(/{{nextTick}}/gi,eventData.curPos==1?'0':eventData.curPos),vidType);}else{var curPos=_playerController.state.position.current(fData,vidType)||'0';fData=_controller.set(fData,eventString.replace(/{{nextTick}}/gi,curPos),vidType);}}
return fData;},preProcess:function(fData,eventData){try{if(fData&&eventData&&eventData.event&&eventData.event!==_eventsController.events.play&&eventData.event.indexOf('event_')===-1){_controller.setNextTick(fData,eventData);if(eventData.event===_eventsController.events.stop&&_playerController.type.current(fData)!=='content'){_controller.setNextTick(fData,eventData,'content');}
_controller.handleEvent(fData,eventData);}}catch(e){}},postProcess:function(fData,eventData){try{if(fData&&eventData&&eventData.event&&eventData.event===_eventsController.events.play){_controller.handleEvent(fData,eventData);}}catch(e){}}};return{get:_controller.get,set:_controller.set,clone:_controller.clone,bind:_controller.bind,clear:_controller.clear,append:_controller.append,isEnabled:_controller.isEnabled,isEventEnabled:_controller.isEventEnabled,preProcess:_controller.preProcess,postProcess:_controller.postProcess,setNextTick:_controller.setNextTick};})();var _playerController={_keys:{currentPosition:'nolPriv_currPos',currentTimestamp:'nolPriv_now',stateCurrentPosition:'nolPriv_stateCurrentPH',stateCurrentTimestamp:'nolPriv_stateCurrentTS',stateCurrentStatus:'nolPriv_stateCurrentStatus',stateCurrentAsset:'nolPriv_stateCurrentAsset',stateCurrentType:'nolPriv_stateCurrentType',statePreviousPosition:'nolPriv_statePreviousPH',statePreviousTimestamp:'nolPriv_statePreviousTS',statePreviousStatus:'nolPriv_statePreviousStatus',statePreviousAsset:'nolPriv_statePreviousAsset',statePreviousType:'nolPriv_statePreviousType',tagName:'nol_comment'},states:{loaded:'LOADED',playing:'PLAYING',paused:'PAUSED',stopped:'STOPPED'},findPlayer:function(obj){if(obj){if(typeof obj==='string'){return $._players[obj];}else{var playerId=Data({data:obj,param:'playerId'});return _playerController.findPlayer(playerId);}}
return null;},currentPosition:function(fData){return cast(Data({data:fData,param:_playerController._keys.currentPosition}),"num");},currentTimestamp:function(fData){return cast(Data({data:fData,param:_playerController._keys.currentTimestamp}),"num");},asset:{current:function(fData){if(fData){return fData._currAssetid;}
return null;},parse:function(metaData){var assetKey=cmsMap.nol_assetid?cmsMap.nol_assetid.clientField:"nol_assetid";return metaData?metaData[assetKey]:null;}},type:{isCurrentlyContent:function(fData){return fData._currVidType==='content';},isCurrentlyAd:function(fData){return fData._currVidType==='ad';},isCurrentlyStatic:function(fData){return fData._currVidType==='static';},current:function(fData){return fData._currVidType;},parse:function(fData,metaData){var clientVidType=cmsMap.nol_vidtype?cmsMap.nol_vidtype.clientField:"nol_vidtype",vidTypeValue=metaData[clientVidType]?metaData[clientVidType].toString().toLowerCase():"",contentIndex=','+Data({data:fData,param:"nol_contentType"});return(vidTypeValue&&contentIndex.indexOf(","+vidTypeValue)!==-1)?"content":(Data({data:fData,param:"nol_product"})==="dcrstatic")?"static":'ad';}},tagName:function(fData,vidType){return Data({data:fData,param:_playerController._keys.tagName,vidType:vidType||fData._currVidType});},isInitialized:function(fData,vidType){try{vidType=vidType||fData._currVidType;return JSON.stringify(fData._dataArrObj[vidType])!=='{}';}catch(e){return false;}},setMetadata:function(fData,metadata){},state:{position:{current:function(fData,vidType){return cast(Data({data:fData,param:_playerController._keys.stateCurrentPosition,vidType:(vidType||fData._currVidType)}),"num");},previous:function(fData,vidType){return cast(Data({data:fData,param:_playerController._keys.statePreviousPosition,vidType:(vidType||fData._currVidType)}),"num");},set:function(fData,ph,vidType){var temp=_playerController.state.position.current(fData);Data({data:fData,param:_playerController._keys.statePreviousPosition,val:temp,vidType:(vidType||fData._currVidType)});Data({data:fData,param:_playerController._keys.stateCurrentPosition,val:ph,vidType:(vidType||fData._currVidType)});}},timeStamp:{current:function(fData,vidType){return cast(Data({data:fData,param:_playerController._keys.stateCurrentTimestamp,vidType:(vidType||fData._currVidType)}),"num");},previous:function(fData,vidType){return cast(Data({data:fData,param:_playerController._keys.statePreviousTimestamp,vidType:(vidType||fData._currVidType)}),"num");},set:function(fData,ah,vidType){var temp=_playerController.state.timeStamp.current(fData);Data({data:fData,param:_playerController._keys.statePreviousTimestamp,val:temp,vidType:(vidType||fData._currVidType)});Data({data:fData,param:_playerController._keys.stateCurrentTimestamp,val:ah,vidType:(vidType||fData._currVidType)});}},asset:{current:function(fData,vidType){return Data({data:fData,param:_playerController._keys.stateCurrentAsset,vidType:(vidType||fData._currVidType)});},previous:function(fData,vidType){return Data({data:fData,param:_playerController._keys.statePreviousAsset,vidType:(vidType||fData._currVidType)});},set:function(fData,assetId,vidType){var temp=_playerController.state.asset.current(fData);Data({data:fData,param:_playerController._keys.statePreviousAsset,val:temp,vidType:(vidType||fData._currVidType)});Data({data:fData,param:_playerController._keys.stateCurrentAsset,val:assetId,vidType:(vidType||fData._currVidType)});}},status:{current:function(fData,vidType){return Data({data:fData,param:_playerController._keys.stateCurrentStatus,vidType:(vidType||fData._currVidType)});},previous:function(fData,vidType){return Data({data:fData,param:_playerController._keys.statePreviousStatus,vidType:(vidType||fData._currVidType)});},set:function(fData,state,vidType){var temp=_playerController.state.status.current(fData,vidType);Data({data:fData,param:_playerController._keys.statePreviousStatus,val:temp,vidType:(vidType||fData._currVidType)});Data({data:fData,param:_playerController._keys.stateCurrentStatus,val:state,vidType:(vidType||fData._currVidType)});}},type:{current:function(fData,vidType){return Data({data:fData,param:_playerController._keys.stateCurrentType,vidType:(vidType||fData._currVidType)});},previous:function(fData,vidType){return Data({data:fData,param:_playerController._keys.statePreviousType,vidType:(vidType||fData._currVidType)});},set:function(fData,type,vidType){var temp=_playerController.state.type.current(fData,vidType);Data({data:fData,param:_playerController._keys.statePreviousType,val:temp,vidType:(vidType||fData._currVidType)});Data({data:fData,param:_playerController._keys.stateCurrentType,val:type,vidType:(vidType||fData._currVidType)});}},set:function(fData,inferredEvent){var player=_playerController.findPlayer(fData);switch(inferredEvent.event){case'LOAD':_playerController.state.asset.set(fData,inferredEvent.assetId);_playerController.state.type.set(fData,inferredEvent.contentType);_playerController.state.timeStamp.set(fData,inferredEvent.timestamp);break;case'PLAY':case'RESUME':_playerController.state.status.set(fData,_playerController.states.playing);_playerController.state.asset.set(fData,inferredEvent.assetId);_playerController.state.type.set(fData,inferredEvent.contentType);_playerController.state.timeStamp.set(fData,inferredEvent.timestamp);if(inferredEvent.event==='PLAY'){_playerController.state.position.set(fData,0);}
if(inferredEvent.event==='RESUME'&&inferredEvent.currentPos!=undefined&&inferredEvent.currentPos!=null&&inferredEvent.currentPos!='{{nextTick}}'){_playerController.state.position.set(fData,inferredEvent.curPos);_playerController.state.timeStamp.set(fData,inferredEvent.timestamp);}
player.pauseObj.eventPauseTime=0;break;case'PAUSE':_playerController.state.status.set(fData,_playerController.states.paused);break;case'STOP':_playerController.state.resetAsset(fData);_playerController.state.status.set(fData,_playerController.states.stopped);break;case'PLAYHEAD':_playerController.state.position.set(fData,inferredEvent.curPos);_playerController.state.timeStamp.set(fData,inferredEvent.timestamp);player.pauseObj.eventPauseTime=0;break;case'REWIND':case'FORWARD':_playerController.state.position.set(fData,inferredEvent.curPos);_playerController.state.timeStamp.set(fData,inferredEvent.timestamp);player.pauseObj.eventPauseTime=0;break;case'MUTE':break;case'event_play':player.pauseObj.eventPauseTime=0;break;};},get:function(fData,vidType){try{if(fData){var state={position:{current:_playerController.state.position.current(fData,vidType),previous:_playerController.state.position.previous(fData,vidType)},timeStamp:{current:_playerController.state.timeStamp.current(fData,vidType),previous:_playerController.state.timeStamp.previous(fData,vidType)},asset:{current:_playerController.state.asset.current(fData,vidType),previous:_playerController.state.asset.previous(fData,vidType)},status:{current:_playerController.state.status.current(fData,vidType),previous:_playerController.state.status.previous(fData,vidType)},type:{current:_playerController.state.type.current(fData,vidType),previous:_playerController.state.type.previous(fData,vidType)}};return state;}}catch(e){}
return null;},resetAsset:function(fData){_playerController.state.position.set(fData,null);_playerController.state.timeStamp.set(fData,null);_playerController.state.asset.set(fData,null);},bind:function(fData,state){try{if(fData&&state){for(var type in state){Data({data:fData,param:_playerController._keys.statePreviousPosition,val:state[type].position?state[type].position.previous:null,vidType:type});Data({data:fData,param:_playerController._keys.stateCurrentPosition,val:state[type].position?state[type].position.current:null,vidType:type});Data({data:fData,param:_playerController._keys.statePreviousTimestamp,val:state[type].timeStamp?state[type].timeStamp.current:null,vidType:type});Data({data:fData,param:_playerController._keys.stateCurrentTimestamp,val:state[type].timeStamp?state[type].timeStamp.current:null,vidType:type});Data({data:fData,param:_playerController._keys.statePreviousAsset,val:state[type].asset?state[type].asset.current:null,vidType:type});Data({data:fData,param:_playerController._keys.stateCurrentAsset,val:state[type].asset?state[type].asset.current:null,vidType:type});Data({data:fData,param:_playerController._keys.statePreviousStatus,val:state[type].status?state[type].status.current:null,vidType:type});Data({data:fData,param:_playerController._keys.stateCurrentStatus,val:state[type].status?state[type].status.current:null,vidType:type});Data({data:fData,param:_playerController._keys.statePreviousType,val:state[type].type?state[type].type.current:null,vidType:type});Data({data:fData,param:_playerController._keys.stateCurrentType,val:state[type].type?state[type].type.current:null,vidType:type});}}}catch(e){}},clone:function(fData){try{return{content:_playerController.state.get(fData,'content'),ad:_playerController.state.get(fData,'ad')};}catch(e){}}}};var _eventsController=(function(){var _events={load:'LOAD',play:'PLAY',pause:'PAUSE',stop:'STOP',resume:'RESUME',rewind:'REWIND',forward:'FORWARD',playhead:'PLAYHEAD',mute:'MUTE',unmute:'UNMUTE'};var _videoController={checkRewind:function(fData,ph){if(fData&&ph!==undefined&&ph!==null&&Data({data:fData,param:"nol_cadence"})!=="stream"&&Data({data:fData,param:"nol_cadence"})!=="impression"){var cur=Math.floor(cast(ph,'num')),prev=_playerController.state.position.current(fData),diff=cur-prev;return{match:diff<0,currentPos:cur,previousPos:prev};}
return false;},checkForward:function(fData,ph){if(fData&&ph!==undefined&&ph!==null&&Data({data:fData,param:"nol_cadence"})!=="stream"&&Data({data:fData,param:"nol_cadence"})!=="impression"){var cur=Math.floor(cast(ph,'num')),prev=_playerController.state.position.current(fData),prevTS=_playerController.state.timeStamp.current(fData),l_intrvlGp=(cast(Data({data:fData,param:"nol_cmsIntrvlGp"}),"num")||2),aj=Math.ceil((getTIme()-prevTS)/1000)||1;if(prev==0&&cur>86400&&_playerController.localTimer(fData)==="nol_cmsoffset"){var ah=getTIme().toString().substr(0,ph.toString().length);if(ah){prev=parseInt(ah);}}
var diff=cur-prev;return{match:diff>l_intrvlGp&&diff>Math.ceil(aj*1.5),currentPos:cur,previousPos:prev};}
return false;}};var _mtvrController={checkRewind:function(fData,ph){var prev=_playerController.currentPosition(fData),prevTS=_playerController.currentTimestamp(fData),l_intrvlGp=cast(Data({data:fData,param:"nol_id3IntrvlGp"}),"num");return false;},checkForward:function(fData,ph){var prev=_playerController.currentPosition(fData),prevTS=_playerController.currentTimestamp(fData),l_intrvlGp=cast(Data({data:fData,param:"nol_id3IntrvlGp"}),"num");return false;}};var _controller={inferEvent:function(eventType,fData,playHead,timestamp,metaData){var inferredEvt=null;try{inferredEvt={event:'event_'+eventType,curPos:_playerController.state.position.current(fData),prevPos:null,timestamp:timestamp};if(eventType&&fData){switch(eventType.toLowerCase()){case"3":case"15":case"loadmetadata":case"pauseloadmeta":var newAsset=_playerController.asset.parse(metaData),oldAsset=_playerController.state.asset.current(fData),prevAsset=_playerController.state.asset.previous(fData),oldType=_playerController.state.type.current(fData),newType=_playerController.type.parse(fData,metaData);inferredEvt.event=_events.load;inferredEvt.assetId=newAsset;inferredEvt.contentType=newType;if(_playerController.state.status.current(fData,newType)==_playerController.states.paused&&((oldAsset==newAsset&&newAsset!==null)||oldType!==newType)){inferredEvt.event=_events.resume;inferredEvt.assetId=newAsset;inferredEvt.contentType=newType;inferredEvt.curPos='{{nextTick}}';break;}
if((_playerController.state.status.current(fData,newType)!==_playerController.states.playing&&oldAsset!=newAsset)||(_playerController.state.status.current(fData,newType)===_playerController.states.stopped&&prevAsset==newAsset&&newAsset!==null)||oldAsset===null){inferredEvt.event=_events.play;inferredEvt.curPos='{{nextTick}}';break;}
break;case'5':case'play':inferredEvt.event='event_play';break;case'7':case'stop':inferredEvt.event='event_stop';break;case"57":case"end":case"oncomplete":inferredEvt.event=_events.stop;break;case'49':case'setplayheadposition':case'playheadposition':if(playHead>-1){var rw=_videoController.checkRewind(fData,playHead);if(rw.match){inferredEvt.event=_events.rewind;inferredEvt.curPos=rw.currentPos;inferredEvt.prevPos=rw.previousPos;inferredEvt.p1=inferredEvt.prevPos-inferredEvt.curPos;break;}
if(_eventDataController.get(fData).indexOf('{{nextTick}}')===-1){var ff=_videoController.checkForward(fData,playHead);if(ff.match){inferredEvt.event=_events.forward;inferredEvt.curPos=ff.currentPos;inferredEvt.prevPos=ff.previousPos;inferredEvt.p1=inferredEvt.curPos-inferredEvt.prevPos;break;}}
if(_playerController.state.status.current(fData)===_playerController.states.paused){inferredEvt.event=_events.resume;inferredEvt.assetId=_playerController.state.asset.current(fData);inferredEvt.contentType=_playerController.type.current(fData);inferredEvt.curPos=playHead;break;}
inferredEvt.event=_events.playhead;inferredEvt.curPos=playHead;}
break;case'55':var bn=Data({data:fData,param:Data({data:fData,param:"nol_timer"})})||Data({data:fData,param:"nol_fdoffset"});if(Data({data:fData,param:"nol_cadence"})==="daypart"){bn=cast(bn,"num");bn+=Data({data:fData,param:"nol_timer"})=="nol_pcoffset"?cast(Data({data:fData,param:"nol_pcTimeCode"}),"num"):cast(Data({data:fData,param:"nol_fdTimeCode"}),"num");}
inferredEvt.event=_events.playhead;break;case'9':case'mute':inferredEvt.event=_events.mute;inferredEvt.p1=playHead;break;};}}catch(e){$._listeners.fireEvent("error",{type:"error",msg:"Error in eventsController. Error inferring event - "+eventType});}
return inferredEvt;}};return{events:_events,inferEvent:_controller.inferEvent};})();function removeParam(sUrl,sParam){var aUrl=[],indexArr=sUrl.split("&"),i,j;for(i=0,j=indexArr.length;i<j;i+=1){if(indexArr[i].indexOf(sParam)!==0){aUrl.push(indexArr[i]);}}
return aUrl.join("&");};var dayCodes=["sun","mon","tue","wed","thu","fri","sat"];function twoDigitsFormat(val){return(val<10)?"0"+val:""+val;};function populateLocalProcessingDate(fData,passedLocalTime){var l_date=new Date(passedLocalTime*1000);var yyyy=l_date.getUTCFullYear().toString(),mm=twoDigitsFormat(l_date.getUTCMonth()+1),dd=twoDigitsFormat(l_date.getUTCDate());Data({data:fData,param:"nol_dayId",val:dayCodes[l_date.getUTCDay()]});Data({data:fData,param:"nol_hourCode",val:twoDigitsFormat(l_date.getUTCHours())});Data({data:fData,param:"nol_dataDate",val:(yyyy+mm+dd)});};function bindEvent(dN,func){var eventArr=dN.split("||"),setEvnt=eventArr[0]||dN;if(window){for(var i=0,j=eventArr.length;i<j;i+=1){setEvnt=eventArr[i];if(typeof window['on'+setEvnt]==='undefined')
continue;if(window.addEventListener){window.addEventListener(setEvnt,func,false);}else if(window.attachEvent){window.attachEvent("on"+setEvnt,func);}}}};function cast(ao,fmt){var y;if(fmt=="num"){y=parseInt(ao,10);ao=isNaN(y)?0:y;}else if(fmt=="bin"){ao=isNaN(Number(ao))?"0":Number(ao).toString(2);}else if(fmt=="bool"){switch(ao.toString().toLowerCase()){case"false":case"no":case"0":case"":ao=false;break;default:ao=true;break;}}else if(fmt=="b2n"){y=parseInt(ao,2);ao=isNaN(y)?0:y;}
return ao;};function cS(size){var i,returnArr=[];for(i=0;i<cast(size,"num");i+=1){returnArr.push({tsv:0,save:false,updated:false});}
return returnArr;};function populateData(data){return{tags:[],aV:(data&&data.aV)?data.aV:[],tagSize:1,bReInit:false,debug:debugDisabledVal,dM:0};};function cs(val){var bU;if(val===undefined||val.length===0){return;}
bU=window.document.createElement('script');bU.type="text/javascript";bU.src=removeParam(val,"rnd=")+"&rnd="+Math.round(Math.random()*1000000);bU.onerror=function(dN){var _url=dN.target.src;if(window.document.head){window.document.head.removeChild(dN.target);}else{window.document.getElementsByTagName('head')[0].removeChild(dN.target);}
if(currentRetry<maxRetry){currentRetry+=1;window.setTimeout(function(){cs(_url);},5000);}};bU.onload=function(eEvt){currentRetry=0;if(window.document.head){window.document.head.removeChild(eEvt.target);}else{window.document.getElementsByTagName('head')[0].removeChild(eEvt.target);}};if(window.document.head){window.document.head.appendChild(bU);}else{window.document.getElementsByTagName('head')[0].appendChild(bU);}};function logger(){var args=Array.prototype.slice.call(arguments);$._listeners.fireEvent("info",{type:"info",msg:args.join(" ")});};function encodeVal(val){return encodeURIComponent(val).replace("'","%27");};function sendSyncData(oArgs){var l_addrProtocol=au.indexOf("https")===0?"https":"http",i,bp,pingSendTime,l_url=oArgs.url,l_maskRef=oArgs.hasOwnProperty("maskRef")?oArgs.maskRef:-1;if(l_url!=="__sendIt"&&l_addrProtocol==="https"&&l_url.indexOf("https")===-1){l_url=l_addrProtocol+l_url.substr(l_url.indexOf("://"));}
if(oArgs.prod&&oArgs.prod==="ocr"&&l_url.indexOf("&ty=js")!==-1){cs(l_url);return;}
if(!sendInterval&&l_url!=="__sendIt"){sender.setup({pingSendTime:calcTimeOffsetByServer(oArgs.serverTimeOffset),url:l_url,maskRefUrl:l_maskRef});}else if(l_url&&sendInterval&&sending){sendQueue2.push(l_url);}else if(l_url==="__sendIt"&&!sending){sending=true;for(i=0,bp=sendQueue.length;i<bp;i+=1){sender.setup({pingSendTime:calcTimeOffsetByServer(oArgs.serverTimeOffset),url:sendQueue.shift(),maskRefUrl:l_maskRef});}
sendQueue=sendQueue.concat(sendQueue2);sending=false;sendQueue2=[];}else if(l_url&&sendInterval&&!sending){sendQueue.push(l_url);}};function xor(ao,pw){var result='',hash,i,bp,pwSize;if(!ao||!pw){return ao;}
pwSize=pw.length;for(i=0,bp=ao.length;i<bp;i+=1){hash=ao.charCodeAt(i)^pw.charCodeAt(i%pwSize);result+=hash===0?ao.charAt(i):String.fromCharCode(hash);}
return result;};function cX(fData,aT,aa,an){var ai,bF;if(aa.indexOf("[")===-1&&aa.indexOf("]")===-1&&(!an.val||an.val.length<=0)){sendError(fData,{type:"100",msg:aa+" missing -- "+Data({data:fData,param:"nol_comment"})});an.state=false;an.val="";}else if(aT==="{"||aT==="}"){an.val=$.CryptoJS.MD5(an.val.toString()).toString();}else if(aT==="<"||aT===">"){ai=aa.match(functionMap["<"].end);if(ai){bF=ai[0].match(/[\d]+/g);an.val=String(an.val).substr(bF[0],bF[1]);}else{an.val=xor(String(an.val),Data({data:fData,param:"nol_xorSeed"}));}}else if(aT==="("||aT===")"){an.val=encodeVal(an.val);}};function cv(fData,L){var T=L.match(/[\[\{<\(]/g),val,J,bO,bV,lookUpEnc,bo,bx,bb,aL,i,l,aS,bq=Data({data:fData,param:"nol_xorSeed"})||"",lookUpKey,l_context;T=T?T.reverse():[];J=L.match(/[\}\]\>\)]/g)||[];bV={start:T.length?L.lastIndexOf(String(T[0])):-1,end:J.length?L.indexOf(String(J[0])):L.length};if(J&&J[0]===">"){bV.end=L.search(functionMap["<"].end)||L.indexOf(">");}
bo=L.substring(bV.start+1,bV.end);aL=bo.split("||");if(aL.length>0){for(i=0,l=aL.length;i<l;i+=1){bo=aL[i];aS=Data({data:fData,param:bo});if(aS&&aS.length>0){break;}}}else{aS=Data({data:fData,param:bo});}
if(aS&&aS.length>0){l_context=(typeof bo==="string")?bo.split('_'):bo;lookUpKey=l_context[0]?l_context.splice(0,2).join('_'):l_context;lookUpEnc=cmsMap[lookUpKey]?cmsMap[lookUpKey].encoding:"";if(lookUpEnc){T=T.reverse().concat(lookUpEnc.match(/[\[\{<\(]/g)).reverse();J=J.reverse().concat(lookUpEnc.match(/[\}\]>\)]/g)).reverse();}}
val={val:aS,state:Data({data:fData,param:"nolPriv_sendData"})};bx=T?T.length:0;bb=J?J.length:0;bO=Math.min(bx,bb);if(bO>0){for(i=0,l=bO;i<l;i+=1){cX(fData,T[0]||J[0],L,val,bq);T.shift();J.shift();}}else if(!val.val||(val.val&&val.val.length<=0)){val.state=false;val.val="";sendError(fData,{type:100,msg:bo+" missing "+Data({data:fData,param:"nol_comment"})});}
return{val:val.val,T:T,J:J};};function cV(fData,configString){var ao,configArr,bP={val:"",state:Data({data:fData,param:"nolPriv_sendData"})},bq=Data({data:fData,param:"nol_md5Seed"}),L,bs,l_level,val=[],aE,T=[],J=[],i,aM="",az,k,j,q,w,l,xorSeed=Data({data:fData,param:"nol_xorSeed"});configString=configString||Data({data:fData,param:"nol_url"})||"";configArr=configString.match(configRegex.bc);if(configArr!==null){for(k=0,j=configArr.length;k<j;k+=1){ao=configArr[k];L=ao.substr(configRegex.length,ao.length-(configRegex.length*2));bs=L.split("+");val=[];aM="";l_level=0;if(bs&&bs.length>1){for(q=0,w=bs.length;q<w;q+=1){aM=bs[q];aE=cv(fData,aM);if(aE.T.length>0){l_level=val.length;T=[].concat(aE.T,T);}
val[l_level]=val[l_level]?val[l_level]+aE.val:aE.val;if((aE.J.length>0)&&(aE.J.length!==T.length)){J=[].concat(J,aE.J);bP={val:val[l_level],state:Data({data:fData,param:"nolPriv_sendData"})};for(i=0,l=aE.J.length;i<l;i+=1){cX(fData,T[0],aM,bP,xorSeed);T.shift();J.shift();}
val[l_level]=bP.val;}}
bP.val=val.join("");az=T.length>=J.length?T:J;for(i=0,l=az.length;i<l;i+=1){cX(fData,az[0],aM,bP,xorSeed);T.shift();J.shift();}}else{aE=cv(fData,L);bP={val:aE.val,state:Data({data:fData,param:"nolPriv_sendData"})};}
configString=configString.replace(ao,bP.val);}}
return configString;};function sendError(fData,msg,force){var errorMsg,errorAddr,errorSent=Data({data:fData,param:"nolPriv_errorSent"});Data({data:fData,param:"nolPriv_sendData",val:false});if(!force&&(!msg||errorSent.indexOf(msg.type.toString()))!==-1){return;}
if(_playerController.isInitialized(fData)){errorMsg=msg.type+","+encodeVal(msg.msg);Data({data:fData,param:"nol_errorMessage",val:errorMsg});$._listeners.fireEvent("error",{type:"error",msg:errorMsg});errorAddr=cV(fData,Data({data:fData,param:"nol_errorURL"}));sendSyncData({serverTimeOffset:Data({data:fData,param:"nolPriv_serverTimeOffset"}),url:errorAddr,maskRef:Data({data:fData,param:"nol_rfrmsk"})});errorSent+=msg.type.toString()+",";Data({data:fData,param:"nolPriv_errorSent",val:errorSent});}};function sendDebug(msg){var logIt=false;if(logIt){logger(msg);}};function dC(url,sService,player){if(player&&!player.serviceSending[sService]){player.serviceSending[sService]=true;cs(url);}};function rounding(unQualSegmentValue,segTimeSpent){var formatValue=unQualSegmentValue||6;return(Math.ceil(segTimeSpent/formatValue)*formatValue)||"0";};function dk(fData,processObj){var bf=false,wonMin=0,thisMinWon=false,l_UnQualDuration=cast(Data({data:fData,param:"nol_unQualSegmentValue"}),"num"),h=Data({data:fData,param:"nol_minutes"}),l_minutes=[],save=processObj?processObj.save:false,i,j,bk,segTimeSpent=cast(Data({data:fData,param:"nol_segmentTimeSpent"}),"num"),sendQual=cast(Data({data:fData,param:"nol_sendQual"}),"num"),nol_cadence=Data({data:fData,param:"nol_cadence"});for(i=0,j=h.length;i<j;i+=1){bk=Math.floor(h[i].tsv/Data({data:fData,param:"nol_creditValue"}));if(bk>=1){if(!h[i].save||(Data({data:fData,param:"nol_cadence"})==="daypart")){l_minutes.push(Data({data:fData,param:"nol_creditFlag"}));wonMin+=1;bf=true;}else{l_minutes.push(0);}
thisMinWon=true;}else{l_minutes.push(0);thisMinWon=false;}
if(!save){h[i].tsv=0;h[i].save=false;h[i].updated=false;}else{h[i].save=thisMinWon;}}
Data({data:fData,param:"nol_duration",val:l_minutes.join("")});if(sendQual){bf=(wonMin>=sendQual);}
if(cast(Data({data:fData,param:"nol_minWonOverride"}),"bool")===true){bf=true;}
if(!bf&&(nol_cadence==="interval"||nol_cadence==="streamduration")&&!save){if(Data({data:fData,param:"nol_segmentPrefix"})==="S"&&l_UnQualDuration){Data({data:fData,param:"nol_duration",val:rounding(l_UnQualDuration,segTimeSpent)});}
bf=(segTimeSpent>1);}
return bf;};function calcTimeOffsetByServer(serverTimeOffset){return(typeof serverTimeOffset!=='undefined')?(getTIme()/1000>>0)+serverTimeOffset:(getTIme()/1000>>0);};function cJ(fData,processObj){var configString=Data({data:fData,param:"nol_url"})||"",bf,oTimeSpentViewing,oTimeSpentViewingAd,oTimeSpentViewingStatic,bu=0,_debugUrl,l_playerId=Data({data:fData,param:"nol_playerId"}),l_maxPingCount=cast(Data({data:fData,param:"nol_maxPingCount"}),"num"),l_pingCount=cast(Data({data:fData,param:"nol_pingCount"}),"num"),aR=processObj?processObj.aR:false,cadence=Data({data:fData,param:"nol_cadence"}),l_eventFilter=Data({data:fData,param:"nol_eventFilter"}),l_maxLength=cast(Data({data:fData,param:"nol_maxLength"}),"num");Data({data:fData,param:"nol_pingCreationTime",val:calcTimeOffsetByServer(Data({data:fData,param:"nolPriv_serverTimeOffset"}))});oTimeSpentViewing=Data({data:fData,param:"nol_timeSpentViewing"})['content'];oTimeSpentViewingAd=Data({data:fData,param:"nol_timeSpentViewing"})['ad'];oTimeSpentViewingStatic=Data({data:fData,param:"nol_timeSpentViewing"})['static'];if(((Data({data:fData,param:"nol_product"})==="dcrvideo"&&oTimeSpentViewing.nol_segmentTimeSpent===0)||(Data({data:fData,param:"nol_product"})==="dcrstatic"&&oTimeSpentViewingStatic.nol_segmentTimeSpent===0))&&(cadence==='interval'||cadence==="streamduration")&&(oTimeSpentViewingAd.nol_count===0&&oTimeSpentViewingAd.nol_segmentTimeSpent===0)){return;}
if(Data({data:fData,param:"nol_disabled"})==="false"&&(l_maxPingCount===0||l_maxPingCount>l_pingCount)){bf=dk(fData,processObj)||cadence==="stream"||cadence==="impression"||Data({data:fData,param:"nol_product"})==="id3";configString=cV(fData,configString);bu=configString.length;if((Data({data:fData,param:"nolPriv_sendData"})&&bf&&!aR)||(l_maxLength>0&&l_maxLength<bu)){if(Data({data:fData,param:"nol_id3Data"})){Data({data:fData,param:"nol_id3Data",val:false});}
logger(Data({data:fData,param:"nol_comment"})," -queued @"+Math.floor(getTIme()/1000)+", timeOffset == "+Data({data:fData,param:"nolPriv_serverTimeOffset"})+", DU == "+Data({data:fData,param:"nol_segmentTimeSpent"})+" -- ",configString);if(l_eventFilter.onSendPing){cG(fData,l_eventFilter.onSendPing);if(Data({data:fData,param:"nol_disabled"})==="true"){return;}}
sendSyncData({serverTimeOffset:Data({data:fData,param:"nolPriv_serverTimeOffset"}),url:configString,prod:Data({data:fData,param:"nol_product"}),maskRef:Data({data:fData,param:"nol_rfrmsk"})});_eventDataController.clear(fData);if(R&&R.hasOwnProperty(l_playerId)&&R[l_playerId].hasOwnProperty("debug")&&R[l_playerId].debug==="logging"){_debugUrl=Data({data:fData,param:"nol_debugUrl"});if(!_debugUrl){_debugUrl=Data({data:fData,param:"nol_prefProtocol"})+"://nielsen.guru/validation/query_string.php?";}
_debugUrl+="pli="+l_playerId+"&sendPing="+Data({data:fData,param:"nol_product"})+"&"+configString.substring(configString.indexOf("?")+1);sendDebug(_debugUrl);}
l_pingCount+=1;oTimeSpentViewing.nol_segmentTimeSpent=0;oTimeSpentViewing.nol_count=0;oTimeSpentViewingAd.nol_segmentTimeSpent=0;oTimeSpentViewingAd.nol_count=0;oTimeSpentViewingStatic.nol_segmentTimeSpent=0;oTimeSpentViewingStatic.nol_count=0;Data({data:fData,param:"nol_pingStartTimeUTC",val:Math.round((getTIme()/1000))});Data({data:fData,param:"nolPriv_priority",val:0});Data({data:fData,param:"nol_pingCount",val:l_pingCount.toString()});}else if(aR){return{bp:bu,fData:configString};}
return null;}};function returnTriggers(fData,offset){var seg=(cast(Data({data:fData,param:"nol_segmentLength"}),"num")*cast(Data({data:fData,param:"nol_segmentValue"}),"num")),t={segment:Math.floor((offset/seg)+1),bk:Math.floor((offset%seg)/Data({data:fData,param:"nol_segmentValue"})),seconds:(offset%Data({data:fData,param:"nol_segmentValue"}))};return t;};function calculateTriggers(sOffset,fData){var bL,l_tagSrc=Data({data:fData,param:"nol_tagSrc"}),sOffset=(sOffset!=="")?sOffset:(l_tagSrc==="id3"&&Data({data:fData,param:"nol_fdcid"})!==Data({data:fData,param:"nol_cidNull"}))?Data({data:fData,param:"nol_fdoffset"}):(l_tagSrc==="id3"&&Data({data:fData,param:"nol_pccid"})!==Data({data:fData,param:"nol_cidNull"}))?Data({data:fData,param:"nol_fdoffset"}):sOffset,l_eventFilter=Data({data:fData,param:"nol_eventFilter"}),h=Data({data:fData,param:"nol_minutes"}),K=cast(Data({data:fData,param:"nol_pingCount"}),"num"),be,i,_i,_j,aA,localUTC,_sendQual,offsetUTC,l_playerId=Data({data:fData,param:"nol_playerId"}),l_player=($._players&&$._players.hasOwnProperty(l_playerId))?$._players[l_playerId]:-1,l_localDay=Data({data:fData,param:"nol_localDay"}),l_localDayQhr=Data({data:fData,param:"nol_dayQhr"}),l_localQhr=Data({data:fData,param:"nol_weekQhr"}),l_localDayOffset,l_localQhrOffset,l_localDayQhrOffset,l_wmDay=Data({data:fData,param:"nol_wmDay"}),l_wmDayQhr=Data({data:fData,param:"nol_wmDayQhr"}),l_wmDayOffset,l_wmDayQhrOffset,l_weekEndUTC=cast(Data({data:fData,param:"nol_weekEndUTC"}),"num"),l_weekStartUTC=cast(Data({data:fData,param:"nol_weekStartUTC"}),"num"),l_weekUTCOffset=l_weekEndUTC-l_weekStartUTC,G,l_timeOffset=cast(Data({data:fData,param:"nolPriv_serverTimeOffset"}),"num"),aj,_localTimer=Data({data:fData,param:"nol_timer"})||"nol_fdoffset",al=cast(Data({data:fData,param:"nolPriv_currMin"}),"num"),_maxPingCount=cast(Data({data:fData,param:"nol_maxPingCount"}),"num"),_credit=cast(Data({data:fData,param:"nol_creditValue"}),"num"),offset=cast(sOffset,"num"),l_intrvlThrshld=cast(Data({data:fData,param:"nol_intrvlThrshld"}),"num")||86400,l_intrvlGp=(_localTimer==="nol_cmsoffset"||_localTimer==="nol_pageoffset")?(cast(Data({data:fData,param:"nol_cmsIntrvlGp"}),"num")||2):cast(Data({data:fData,param:"nol_id3IntrvlGp"}),"num"),seg=(cast(Data({data:fData,param:"nol_segmentLength"}),"num")*cast(Data({data:fData,param:"nol_segmentValue"}),"num")),currSeg=cast(Data({data:fData,param:"nol_currSeg"}),"num"),now=cast(Data({data:fData,param:"nolPriv_now"}),"num"),currData,oTimeSpentViewing=Data({data:fData,param:"nol_timeSpentViewing"})[fData._currVidType],dn=cast(Data({data:fData,param:"nolPriv_currPos"}),"num");l_wmDayOffset=Math.floor(offset/86400)+1;if(!l_wmDay){Data({data:fData,param:"nol_wmDay",val:l_wmDayOffset});}
l_wmDayQhrOffset=Math.floor((offset%86400)/900)+1;if(!l_wmDayQhr){Data({data:fData,param:"nol_wmDayQhr",val:l_wmDayQhrOffset});}
if(offset>86400&&_localTimer==="nol_cmsoffset"){offset=offset+l_timeOffset;offsetUTC=offset+cast(Data({data:fData,param:"nol_startDayTimeOffset"}),"num");localUTC=offsetUTC+cast(Data({data:fData,param:"nol_GMTOffset"}),"num");}else{offsetUTC=localUTC=offset;}
l_localDayOffset=Math.floor(localUTC/86400)+1;if(l_localDay&&l_localDay!=l_localDayOffset){cJ(fData);}
if(!l_localDay){Data({data:fData,param:"nol_localDay",val:l_localDayOffset});}
if(offset>l_weekEndUTC){if(l_eventFilter.onWeekEndUTC){cG(fData,l_eventFilter.onWeekEndUTC);}else{Data({data:fData,param:"nol_week",val:Data({data:fData,param:"nol_nextWeek"})});Data({data:fData,param:"nol_period",val:Data({data:fData,param:"nol_nextPeriod"})});Data({data:fData,param:"nol_weekStartUTC",val:l_weekEndUTC+1});Data({data:fData,param:"nol_weekEndUTC",val:l_weekEndUTC+1+l_weekUTCOffset});}}
l_localQhrOffset=Math.floor((offset-cast(Data({data:fData,param:"nol_weekStartUTC"}),"num"))/900)+1;if(!l_localQhr||(l_localQhrOffset!==l_localQhr)){Data({data:fData,param:"nol_weekQhr",val:l_localQhrOffset});}
if(_localTimer==="nol_cmsoffset"){offset=localUTC%86400;}
l_localDayQhrOffset=Math.floor(offset/900)+1;if(!l_localDayQhr){Data({data:fData,param:"nol_dayQhr",val:l_localDayQhrOffset});}
offset=Math.floor(offset);if(Data({data:fData,param:"nol_disabled"})==="true"||offset===undefined||(_maxPingCount>0&&(_maxPingCount<=K)&&Data({data:fData,param:"nol_cadence"})!=="daypart")){return;}
var processingTimezone=Data({data:fData,param:"nol_devTimeZone"}),timeCode=/^GMT([-+]?)([0-9]+):([0-9]+)$/.exec(processingTimezone);if(timeCode){var seconds=(timeCode[1]=='-')?-60:60;populateLocalProcessingDate(fData,getTIme()/1000+seconds*(Number(timeCode[2])*60+Number(timeCode[3])));}
if(Data({data:fData,param:"nol_cadence"})!=="stream"&&Data({data:fData,param:"nol_cadence"})!=="impression"){dn=(dn==="")?offset:cast(dn,"num");if(!now){now=getTIme();}
aj=Math.ceil((getTIme()-now)/1000)||1;currData=returnTriggers(fData,dn);bL=currData.segment;G=currData.bk;be=currData.seconds;aA=offset-dn;Data({data:fData,param:"nolPriv_currPos",val:offset});if(currSeg&&bL!==undefined&&currSeg!==bL){if(Data({data:fData,param:"nol_product"})!=='dcrvideo'||(Data({data:fData,param:"nol_product"})==='dcrvideo'&&Data({data:fData,param:"nol_segmentTimeSpent"})>0)){cJ(fData,{save:true});}
if(Data({data:fData,param:"nol_cadence"})!=="episode"){Data({data:fData,param:"nol_pingCount",val:0});}
h=cS(Data({data:fData,param:"nol_segmentLength"}));Data({data:fData,param:"nol_minutes",val:h});if(l_localDayQhr&&l_localDayQhr!==l_localDayQhrOffset){Data({data:fData,param:"nol_dayQhr",val:l_localDayQhrOffset});Data({data:fData,param:"nol_weekQhr",val:l_localQhrOffset});if(l_localDay&&l_localDay!==l_localDayOffset){Data({data:fData,param:"nol_localDay",val:l_localDayOffset});}}
if(l_wmDayQhr&&l_wmDayQhr!==l_wmDayQhrOffset){Data({data:fData,param:"nol_wmDayQhr",val:l_wmDayQhrOffset});}
if(l_wmDay&&l_wmDay!==l_wmDayOffset){Data({data:fData,param:"nol_wmDay",val:l_wmDayOffset});}}
currSeg=bL;if(G!==undefined&&aA>0){if(al!==G){if(!h[G].save&&Data({data:fData,param:"nol_cadence"})!=="daypart"){if(h[G].tsv>=_credit){cJ(fData);}else{h[G].tsv=0;h[G].updated=false;}}}
if(aA<l_intrvlGp||((aA<=Math.ceil(aj*1.5))&&aA<l_intrvlThrshld)){_sendQual=cast(Data({data:fData,param:"nol_sendQual"}),"num");for(i=0;i<aA;i+=1){if((be+i)%Data({data:fData,param:"nol_segmentValue"})!==0){(h[G].tsv)+=1;oTimeSpentViewing.nol_cumeTimeSpent+=1;oTimeSpentViewing.nol_segmentTimeSpent+=1;if(h[G].tsv>=_credit&&_sendQual){if(!h[G].updated){Data({data:fData,param:"nolPriv_priority",val:getTIme()});h[G].updated=true;}
for(_i=0,_j=0;_i<h.length;_i+=1){_j+=(h[_i].tsv>=_credit)?1:0;if(_j>=_sendQual){_sendQual="send";break;}}
if(_sendQual==="send"&&Data({data:fData,param:"nol_sendQual"})){if(l_eventFilter.onViewWon){cG(fData,l_eventFilter.onViewWon);}
cJ(fData,{save:true});_sendQual=0;if(Data({data:fData,param:"nol_cadence"})!=="daypart"){Data({data:fData,param:"nol_sendQual",val:"0"});}}}
if(Data({data:fData,param:"nol_cadence"})!=="daypart"&&h[G].tsv>Data({data:fData,param:"nol_segmentValue"})){if(!h[G].save){cJ(fData);}else{h[G].tsv=1;h[G].save=false;h[G].updated=false;}}}else{if(i!==0){G+=1;}
if(h.length<=G){cJ(fData,{save:true});G=0;currSeg+=1;Data({data:fData,param:"nol_currSeg",val:currSeg});Data({data:fData,param:"nol_pingCount",val:0});h=cS(Data({data:fData,param:"nol_segmentLength"}));Data({data:fData,param:"nol_minutes",val:h});if(l_localDayQhr&&l_localDayQhr!==l_localDayQhrOffset){Data({data:fData,param:"nol_dayQhr",val:l_localDayQhrOffset});Data({data:fData,param:"nol_weekQhr",val:l_localQhrOffset});if(l_localDay&&l_localDay!==l_localDayOffset){Data({data:fData,param:"nol_localDay",val:l_localDayOffset});}}
if(l_wmDayQhr&&l_wmDayQhr!==l_wmDayQhrOffset){Data({data:fData,param:"nol_wmDayQhr",val:l_wmDayQhrOffset});}
if(l_wmDay&&l_wmDay!==l_wmDayOffset){Data({data:fData,param:"nol_wmDay",val:l_wmDayOffset});}}else if(Data({data:fData,param:"nol_cadence"})!=="daypart"&&!h[G].save&&h[G].tsv>=_credit){cJ(fData);}else if(!h[G].save){h[G].tsv=1;h[G].updated=false;}
be=1;oTimeSpentViewing.nol_cumeTimeSpent+=1;oTimeSpentViewing.nol_segmentTimeSpent+=1;}
Data({data:fData,param:"nolPriv_currMin",val:G});}}
Data({data:fData,param:"nolPriv_now",val:getTIme()});if(l_player!==-1&&Data({data:fData,param:"nol_product"})!=='dcrstatic'){l_player.pauseObj.pauseTime=0;}}}else{bL=Math.floor((offset/seg)+1);if(Data({data:fData,param:"nol_ac"})==="content"){currSeg=bL;Data({data:fData,param:"nol_currSeg",val:currSeg});}
cJ(fData);}
Data({data:fData,param:"nol_currSeg",val:currSeg});};function cQ(fData,aY,dr){var x2=Data({data:fData,param:"iag_"+aY});if(x2!==undefined&&x2!==""){dr="&pr=iag."+aY+","+encodeVal(x2);}else{if(dr&&dr.length>0&&dr.indexOf("&pr=iag")===-1){dr="&pr=iag."+aY+","+encodeVal(dr);}else if(dr===undefined||dr===null){dr="";}}
return dr;};function dz(fData,ac){var iag,sid,tfid,bcr,pgm,epi,seg,pd,oad,brn,cte,ap,ifp,ipod,iapt,icust1,ab=Data({data:fData,param:"nol_vidtype"});if(Data({data:fData,param:"nol_prod"}).indexOf("iag")>=0){iag="";}else{return;}
sid=cQ(fData,"sid",Data({data:fData,param:"nol_sid",vidType:"content"}));tfid=cQ(fData,"tfid",Data({data:fData,param:"nol_tfid",vidType:"content"}));bcr=cQ(fData,"bcr",Data({data:fData,param:"nol_clientid",vidType:"content"}));epi=cQ(fData,"epi",(Data({data:fData,param:"nol_title"})||Data({data:fData,param:"nol_title",vidType:"content"})));pgm=cQ(fData,"pgm",(Data({data:fData,param:"nol_censuscategory"})||Data({data:fData,param:"nol_category"})||Data({data:fData,param:"nol_iagcategory"})));if(!pgm){pgm=cQ(fData,"pgm",(Data({data:fData,param:"nol_censuscategory",vidType:"content"})||Data({data:fData,param:"nol_category",vidType:"content"})||Data({data:fData,param:"nol_iagcategory",vidType:"content"})));if(!pgm){pgm="&pr=iag.pgm,general";}}
seg="&pr=iag.seg,";if(cast(Data({data:fData,param:"nol_chapter",vidType:"content"}),"num")>1){seg+=Data({data:fData,param:"iag_seg"})||Data({data:fData,param:"nol_chapter",vidType:"content"});}else{seg+="1";}
pd=cQ(fData,"pd",pd);oad=cQ(fData,"oad",oad);ifp=cQ(fData,"fp",ifp);icust1=cQ(fData,"cust1",icust1);if(ac==="ad"){brn="&pr=iag.brn,"+Data({data:fData,param:"nol_clientid"});cte="&pr=iag.cte,"+encodeVal(Data({data:fData,param:"nol_adURL"}));if(ab==="midroll"){ap="&pr=iag.ap,mid";}else if(ab==="postroll"){ap="&pr=iag.ap,post";}else{ap="&pr=iag.ap,pre";}
sid=cQ(fData,"sid",sid);tfid=cQ(fData,"tfid",tfid);bcr=cQ(fData,"bcr",bcr);brn=cQ(fData,"brn",brn);cte=cQ(fData,"cte",cte);pgm=cQ(fData,"pgm",pgm);epi=cQ(fData,"epi",epi);seg=cQ(fData,"seg",seg);pd=cQ(fData,"pd",pd);oad=cQ(fData,"oad",oad);ipod=cQ(fData,"pod",ipod);iapt=cQ(fData,"apt",iapt);iag=sid+tfid+bcr+pgm+epi+seg+pd+brn+ap+cte+oad+ifp+ipod+iapt+icust1;}else{iag=sid+tfid+bcr+pgm+epi+seg+pd+oad+ifp+icust1;}
iag+="&pr=iag.cp,soc";Data({data:fData,param:"nol_iagData",val:iag});};function dI(e){var _debugUrl;if(R[e.id]&&R[e.id].tags.length===R[e.id].tagSize){$._listeners.fireEvent("debug",{type:"debug",msg:"pli="+e.id+"&ggpm="+JSON.stringify(e)});if(R[e.id].debug!==debugDisabledVal){if(R[e.id].debug==="logging"){_debugUrl=R[e.id].nol_debugUrl;if(!_debugUrl){_debugUrl=R[e.id].nol_prefProtocol+"://nielsen.guru/validation/query_string.php?";}
if(R[e.id].aV.length>R[e.id].dM+1){for(var i=R[e.id].dM;i<R[e.id].aV.length;i++){sendDebug(_debugUrl+"pli="+e.id+"&ggpm="+JSON.stringify(R[e.id].aV[i]));R[e.id].dM=i;}}
_debugUrl+="pli="+e.id+"&ggpm="+JSON.stringify(e);sendDebug(_debugUrl);}}
e.timeStamp=getTIme();for(var i=0,j=R[e.id].tags.length;i<j;i+=1){if(R.hasOwnProperty(e.id)){R[e.id].tags[i].eventListener(e);}}}else{if(!R[e.id]||!R[e.id].aV){R[e.id]=populateData(R[e.id]);}
R[e.id].aV.push(e);}};function reInit(lastEvt,playerId){var i,j;if(R[playerId].bReInit){return;}
R[playerId].bReInit=true;R[playerId].aV=[];if(lastEvt){R[playerId].aV.push(lastEvt);}
cs(configAddr);};function cd(type,bC,ao){var bz=false,aq=ao.toString().toLowerCase().indexOf(bC.toString().toLowerCase());if(type==="-"&&aq===-1){bz=true;}else if(type==="+"&&(ao===bC||(aq!==-1&&ao&&bC))){bz=true;}else if(type==="--"&&bC.toString().toLowerCase().indexOf(ao.toString().toLowerCase())===-1){bz=true;}else if(type==="++"&&bC.toString().toLowerCase().indexOf(ao.toString().toLowerCase())!==-1){bz=true;}
return bz;};function cG(fData,filters,oTempData){var aH=filters||Data({data:fData,param:"nol_finalFilter"}),i,j,k,l,m,ay,by,F,bg,aQ,_do,tempData=oTempData||{};if(!aH||aH===undefined){return;}
for(i=0,j=aH.length;i<j;i+=1){F=aH[i];if(F.tagVar.length){for(var k=0,l=F.tagVar.length;k<l;k++){aQ=Data({data:fData,param:F.tagVar[k].name});if(!aQ){break;}}}else{aQ=Data({data:fData,param:F.tagVar.name});}
if(aQ&&(F.tagVar.value===aQ)){for(k=0,l=F.cond.length;k<l;k+=1){by=tempData[F.cond[k]]||Data({data:fData,param:F.cond[k]});ay=F.is.value.indexOf("nol_")===0&&Data({data:fData,param:F.is.value})?Data({data:fData,param:F.is.value}):F.is.value;if(by===undefined||ay===undefined||!cd(F.is.type,by,ay)){bg=false;break;}
bg=true;}
if(bg!==undefined){if(bg){_do=F.then;}else{_do=F.else;}
if(_do!==undefined){for(m in _do){if(_do.hasOwnProperty(m)){if(tempData.nol_vidtype!==undefined){tempData[m]=_do[m];}else{Data({data:fData,param:m,val:_do[m]});}}}}}}}};function settings(oVal,value){var aU,_settings=oVal.data._settings,v=oVal.param;if(value===undefined||value===null){if(_settings.hasOwnProperty(v)&&R[_settings.playerId].nol_tagMap.hasOwnProperty(v)&&(typeof R[_settings.playerId].nol_tagMap[v]==="object"||typeof R[_settings.playerId].nol_tagMap[v]==="array")){aU=R[_settings.playerId].nol_tagMap[v][_settings[v]];}else{aU=_settings.hasOwnProperty("nol_defaults")&&_settings.nol_defaults.hasOwnProperty(v)?_settings.nol_defaults[v]:R[_settings.playerId].nol_tagMap.nol_defaults[v]||R[_settings.playerId][v];}
if(aU===undefined){aU=_settings.hasOwnProperty(v)?_settings[v]:R[_settings.playerId].nol_tagMap[v];}}else{if(_settings.hasOwnProperty("nol_defaults")&&_settings.nol_defaults.hasOwnProperty(v)){_settings.nol_defaults[v]=value;}else{_settings[v]=value;}}
return aU;};function Data(oVal){if(oVal){var __param=(typeof oVal.param==="string")?oVal.param.split('_'):oVal.param,retVal,param=__param[0]?__param.splice(0,2).join('_'):__param,l_vidtype=oVal.vidType||__param[0]||oVal.data._currVidType,l_assetid=oVal.data._currAssetid||"0",l_val=oVal.data._dataArrObj[l_vidtype][l_assetid],_param=cmsMap[param]?cmsMap[param].clientField:param;if(typeof _param==="object"){retVal=l_val;}else if(_param==="nol_segmentTimeSpent"||_param==="nol_cumeTimeSpent"||_param==="nol_count"){var oTimeSpentViewing=Data({data:oVal.data,param:"nol_timeSpentViewing"});retVal=oTimeSpentViewing[l_vidtype][_param];}else if(oVal.val===undefined||oVal.val===null){retVal=l_val?l_val[_param]:R[oVal.data._settings.playerId][_param];if(retVal===undefined||retVal===""){if(_param.indexOf("nol_")===0){oVal.param=_param;}else{oVal.param=param;}
retVal=settings(oVal)||"";}}else if(l_val){l_val[_param]=oVal.val;}
return retVal;}else{return null;}};function callService(fData,oParams){var _player=_playerController.findPlayer(fData);var stnSvr=_player.oServiceCall[oParams.service],stnURL=oParams.url,station=oParams.key,i;oParams.evntCB=Data({data:fData,param:fData.serviceFlag[oParams.service].callback});oParams.callBack=function(e){stnUpdate(fData,e,oParams);};if(!stnSvr&&station&&stnURL&&stnURL.length>0){$._listeners.addListener(oParams.evntCB,oParams.callBack,true);dC(cV(fData,stnURL),oParams.service,_player);}else if(stnSvr&&stnSvr.status==="complete"&&station!==stnSvr.station){$._listeners.addListener(oParams.evntCB,oParams.callBack,true);dC(cV(fData,stnURL),oParams.service,_player);}else if(stnSvr&&stnSvr.status==="complete"&&station===stnSvr.station){for(i in stnSvr.data){if(stnSvr.data.hasOwnProperty(i)){Data({data:fData,param:i,val:stnSvr.data[i]});}}
if(l_serviceFilter){cG(fData,l_serviceFilter[oParams.service]);}else{cG(fData,l_eventFilter);}
if(Data({data:fData,param:"nol_disabled"})==="true"){return;}
if(fData.serviceFlag[oParams.service].need){Data({data:fData,param:"nol_davState",val:"1"});fData.serviceFlag[oParams.service].need=false;calculateTriggers(Data({data:fData,param:"nol_queueTime"}),fData);}}else{window.setTimeout(function(){callService(fData,oParams);},1000);}};function stnUpdate(fData,stnObj,oParams){var _data={},nol_queueTime,timeCode=0,i;if(Data({data:fData,param:"nol_playerId"})===stnObj.target.nol_playerId){for(i in stnObj.target){if(stnObj.target.hasOwnProperty(i)){Data({data:fData,param:i,val:stnObj.target[i]});_data[i]=stnObj.target[i];}}
var player=_playerController.findPlayer(fData);if(player){player.oServiceCall[oParams.service]={status:"complete",station:oParams.key,data:_data};player.serviceSending[oParams.service]=false;}
if(l_serviceFilter){cG(fData,l_serviceFilter[oParams.service]);}else{cG(fData,l_eventFilter);}
if(Data({data:fData,param:"nol_disabled"})==="true"){return;}
if(fData.serviceFlag[oParams.service].need){Data({data:fData,param:"nol_davState",val:"1"});fData.serviceFlag[oParams.service].need=false;if(stnObj.target.hasOwnProperty("nol_fdTimeCode")&&Data({data:fData,param:"nol_cadence"})==="daypart"){timeCode=cast(stnObj.target.nol_fdTimeCode,"num");nol_queueTime=cast(Data({data:fData,param:"nol_queueTime"}),"num");Data({data:fData,param:"nol_queueTime",val:(nol_queueTime+timeCode)});}
calculateTriggers(Data({data:fData,param:"nol_queueTime"}),fData);}}};function checkStop(fData){if(Data({data:fData,param:"nol_product"})==="id3"&&Data({data:fData,param:"nol_id3Data"})){cJ(fData);return;}
if(Data({data:fData,param:"nol_disabled"})==="true"){return;}
if(Data({data:fData,param:"nol_davState"})==="1"){Data({data:fData,param:"nol_davState",val:"2"});if(Data({data:fData,param:"nol_cadence"})==="daypart"){cJ(fData,{save:true});}else{cJ(fData);}
var l_minutes=cS(Data({data:fData,param:"nol_segmentLength"}));Data({data:fData,param:"nol_minutes",val:l_minutes});Data({data:fData,param:"nol_duration",val:new Array(l_minutes.length+1).join('0')});Data({data:fData,param:"nol_disabled",val:"true"});}};function handleStopEvent(fData){if(Data({data:fData,param:"nol_product"})==="dcrstatic"&&Data({data:fData,param:"nol_cadence"})!=="stream"){return;}
if((Data({data:fData,param:"nol_ac"})==="content"&&Data({data:fData,param:"nol_segmentTimeSpent"})>0)||(Data({data:fData,param:"nol_cadence"})==="streamduration"&&Data({data:fData,param:"nol_segmentTimeSpent"})>0)||(Data({data:fData,param:"nol_product"})==="dcrstatic"&&Data({data:fData,param:"nol_cadence"})==="stream")||(Data({data:fData,param:"nol_vidtype"})==="postroll"&&Data({data:fData,param:"nol_cadence"})==="interval")){if(Data({data:fData,param:"nol_ac"})==="content"){cJ(fData,{save:true});}else{cJ(fData);}
Data({data:fData,param:"nolPriv_now",val:0});}};function ggpmPreProc(fData,options){var inferredEvent=null,ah=getTIme();try{if(fData){if(_eventDataController.isEnabled(fData)){inferredEvent=_eventsController.inferEvent(options.currEvtType,fData,options.bJ,ah,options.cq);if(inferredEvent){if(inferredEvent.event!==_eventsController.events.play){_playerController.state.set(fData,inferredEvent);}
_eventDataController.preProcess(fData,inferredEvent);}}}}catch(e){$._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPreProc(). Error preprocessing event - "+e.message});}
return{inferredEvent:inferredEvent,timestamp:ah};};function ggpmPostProc(fData,options){try{if(fData&&options.inferredEvent){if(options.inferredEvent.event===_eventsController.events.play){_playerController.state.set(fData,options.inferredEvent);}
_eventDataController.postProcess(fData,options.inferredEvent);}}catch(e){$._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPostProc(). Error postprocessing event - "+e.message});}};function cA(fData,dN){var l_playerId=Data({data:fData,param:"nol_playerId"});if(l_playerId!==dN.id){return;}
var eventInfo=dN.evtInfo,bJ=eventInfo.param1,cq=eventInfo.param3||bJ.param3||bJ,pointer,volNow,volSaved,muteSaved,_id3Count=cast(Data({data:fData,param:"nolPriv_id3Count"}),"num"),l_val,wmRaw,ah,l_tsv=Data({data:fData,param:"nol_segmentSpentViewing"}),enableFilterMap=Data({data:fData,param:"nol_enableFilterMap"}),tsvProducts="|mtvr|,|dprid3|,|id3|",aC,aa,bm={filters:{onId3PcCidChanged:false,onId3FdCidChanged:false},count:0,filterType:"old"},bn,tsvKey,clientChannelName,prod=Data({data:fData,param:"nol_prod"}),id3Seq,preDataObj={},currEvtType=eventInfo.eventType.toString(),i,l_vidType='content',j,_s,_du,l_timeOffset=Data({data:fData,param:"nolPriv_serverTimeOffset"}),clientVidType=cmsMap.nol_vidtype?cmsMap.nol_vidtype.clientField:"nol_vidtype",clientTagSrc=cmsMap.nol_tagSrc?cmsMap.nol_tagSrc.clientField:"nol_tagSrc",clientAssetid=cmsMap.nol_assetid?cmsMap.nol_assetid.clientField:"nol_assetid",clientAdOrContent=cmsMap.nol_ac?cmsMap.nol_ac.clientField:"nol_ac",clientLinearAdLoadFlag=cmsMap.nol_linearAdLoadFlag?cmsMap.nol_linearAdLoadFlag.clientField:"nol_linearAdLoadFlag",vidTypeValue=cq[clientVidType]?cq[clientVidType].toString().toLowerCase():"",now=Math.round(getTIme()/1000),l_key='nol_assetid';var preProcData=ggpmPreProc(fData,{currEvtType:currEvtType,bJ:bJ,cq:cq});switch(currEvtType.toLowerCase()){case"3":case"14":case"15":case"loadmetadata":case"staticstart":case"pauseloadmeta":if((currEvtType==='14'||currEvtType==="staticstart")&&Data({data:fData,param:"nol_product"})!=="dcrstatic"){return;}
if((currEvtType!=='14'&&currEvtType!=="staticstart")&&Data({data:fData,param:"nol_product"})==="dcrstatic"){return;}
var contentIndex=','+Data({data:fData,param:"nol_contentType"});fData._currVidType=(vidTypeValue&&contentIndex.indexOf(","+vidTypeValue)!==-1)?"content":(Data({data:fData,param:"nol_product"})==="dcrstatic")?"static":'ad';var tempState=null,evData=null;if((Data({data:fData,param:"nol_ac"})==="ad"&&Data({data:fData,param:"nol_segmentTimeSpent"})>0&&Data({data:fData,param:"nol_cadence"})==="streamduration")||(Data({data:fData,param:"nol_cadence"})==="stream"&&Data({data:fData,param:"nol_product"})==="dcrstatic")||(Data({data:fData,param:"nol_product"})==="dcrstatic"&&String(fData._currAssetid)!==String(cq[clientAssetid]))){checkStop(fData);}
if(Data({data:fData,param:"nol_onCompleteFired"})===true){if(fData._currVidType==="content"||fData._currVidType==="static"){R[l_playerId]["nol_sessionId"]=getTIme();Data({data:fData,param:l_key,val:-1});if(fData._currVidType==="content"){tempState=_playerController.state.clone(fData);evData=_eventDataController.clone(fData);resetDataObj(fData);}else{resetDataObj(fData,true);}}
Data({data:fData,param:"nol_onCompleteFired",val:false});}else if((currEvtType==='14'||currEvtType==="staticstart")&&(Data({data:fData,param:"nol_cadence"})==="stream")){Data({data:fData,param:l_key,val:-1});resetDataObj(fData);}
if(fData._currVidType==="ad"){var l_minutes=cS(Data({data:fData,param:"nol_segmentLength"}));Data({data:fData,param:"nol_minutes",val:l_minutes});Data({data:fData,param:l_key,val:-1});Data({data:fData,param:clientVidType,val:vidTypeValue});}
fData._currAssetid=((Data({data:fData,param:"nol_cadence"})==="daypart")||(Data({data:fData,param:"nol_cadence"})!=="stream"&&Data({data:fData,param:"nol_product"})==="dcrstatic"))?cq[clientAssetid]:fData._currAssetid;cq.nol_ac=fData._currVidType;if(cast(Data({data:fData,param:"nol_serverTime"}),"num")+86400<Math.round(getTIme()/1000)+l_timeOffset){checkStop(fData);reInit(dN,Data({data:fData,param:"nol_playerId"}));return;}
for(i=0,j=enableFilterMap.length;i<j;i+=1){pointer=cmsMap[enableFilterMap[i]]?cmsMap[enableFilterMap[i]].clientField:enableFilterMap[i];preDataObj[enableFilterMap[i]]=String(cq[pointer]||"");}
l_val=String(cq[clientAssetid]);cG(fData,l_eventFilter.onCmsDetected,preDataObj);if(preDataObj.nol_disabled!=="false"||!cq){if(fData._currTagSrc!=="cms"){init(fData,"loadMetadata",cq);Data({data:fData,param:"nol_disabled",val:"true"})}
return;}
if(fData._currVidType==="static"&&Data({data:fData,param:"nol_product"})==="dcrstatic"){$._listeners.fireEvent("updateCmbStaticPage",{evtInfo:eventInfo,plid:l_playerId});l_vidType='static';}else{l_vidType='content';}
if(l_val!==Data({data:fData,param:l_key})){if(Data({data:fData,param:"nol_ac"})!=="ad"){checkStop(fData);}
init(fData,"loadMetadata",cq);cG(fData,l_eventFilter.onAssetIdChanged);if(Data({data:fData,param:"nol_disabled"})==="true"){return;}
if(Data({data:fData,param:"nol_product"})==="drm"){fData.serviceFlag.stn.need=true;}else{fData.serviceFlag.stn.need=false;if(Data({data:fData,param:"nol_disabled"})==="true"){return;}}
cG(fData,l_eventFilter.onComplete);if(tempState){_playerController.state.bind(fData,tempState);}
if(evData){_eventDataController.bind(fData,evData);}
if(Data({data:fData,param:"nol_disabled"})==="true"){return;}}
if(fData._currVidType==="ad"&&Data({data:fData,param:"nol_product"})==="dcrvideo"&&Data({data:fData,param:"nol_cadence"})!=='impression'){var oTimeSpentViewing=Data({data:fData,param:"nol_timeSpentViewing"});oTimeSpentViewing[fData._currVidType].nol_count++;}
Data({data:fData,param:"nol_pingStartTimeUTC",val:Math.round((getTIme()/1000))});if(prod.indexOf("iag")!==-1){dz(fData,fData._currVidType,cmsMap);}
if((fData._currVidType==="ad"&&Data({data:fData,param:"nol_product"})!=="dcrvideo")||Data({data:fData,param:"nol_cadence"})==="stream"){Data({data:fData,param:"nol_pingCount",val:0});Data({data:fData,param:"nolPriv_sendData",val:true});Data({data:fData,param:"nol_davState",val:"0"});if(!fData.serviceFlag.stn.need&&(fData._currVidType!=="content")&&(Data({data:fData,param:"nol_timer"})==="nol_cmsoffset"||Data({data:fData,param:"nol_timer"})==="nol_pageoffset")){calculateTriggers(0,fData);}}
break;case"5":case"play":if(Data({data:fData,param:"nol_product"})==="mtvr"){clientChannelName=cmsMap.nol_channelName?cmsMap.nol_channelName.clientField:"nol_channelName";if(cq[clientChannelName]&&cq[clientChannelName].length>0){for(_s in cq){if(cq.hasOwnProperty(_s)){Data({data:fData,param:_s,val:cq[_s]});}}}}else if(Data({data:fData,param:"nol_product"})==="dcrvideo"){fData._currVidType="content";preDataObj={nol_vidtype:Data({data:fData,param:clientVidType,vidType:fData._currVidType}),nol_tagSrc:Data({data:fData,param:clientTagSrc,vidType:fData._currVidType}),nol_linearAdLoadFlag:Data({data:fData,param:clientLinearAdLoadFlag,vidType:fData._currVidType}),nol_ac:Data({data:fData,param:clientAdOrContent,vidType:fData._currVidType})};cG(fData,l_eventFilter.onCmsDetected,preDataObj);}
break;case"6":case"pause":handleStopEvent(fData);break;case"7":case"stop":handleStopEvent(fData);break;case"updateott":handleStopEvent(fData);var l_player=_playerController.findPlayer(fData);if(bJ&&bJ.hasOwnProperty('ottStatus')&&bJ['ottStatus'].length>0){for(var l_key in bJ){if(bJ.hasOwnProperty(l_key)){Data({data:fData,param:l_key,val:bJ[l_key],vidType:"content"});l_player.ottStatusObj[l_key]=bJ[l_key];}}
if(l_eventFilter.onOTTDetected){cG(fData,l_eventFilter.onOTTDetected);}}
break;case"57":case"56":case"end":case"oncomplete":case"staticend":if((currEvtType==='56'||currEvtType==='staticend')&&Data({data:fData,param:"nol_product"})!=="dcrstatic"){return;}
if((currEvtType!=='56'&&currEvtType!=='staticend')&&Data({data:fData,param:"nol_product"})==="dcrstatic"){return;}
if(fData._currVidType==="ad"){if((Data({data:fData,param:"nol_cadence"})==="streamduration")){cJ(fData);}else if((Data({data:fData,param:"nol_product"})==="dcrvideo")&&Data({data:fData,param:"nol_cadence"})==="interval"){fData._currVidType='content';cJ(fData);}}
if(Data({data:fData,param:"nol_ac"})!=="static"){fData._currVidType='content';}
if(Data({data:fData,param:"nol_disabled"})==="false"||Data({data:fData,param:"nol_product"})==="id3"){if(Data({data:fData,param:"nol_ac"})==="static"){$._listeners.fireEvent("removeCmbAssetId",eventInfo);}
checkStop(fData);}
Data({data:fData,param:"nol_onCompleteFired",val:true});break;case"48":case"setpageduration":case"pageduration":case"staticposition":if(Data({data:fData,param:"nol_disabled"})==="true"||!bJ||Data({data:fData,param:"nol_timer"})!=="nol_pageoffset"){return;}
_du=cast(Data({data:fData,param:"nol_highWM"}),"num");if(_du<cast(bJ,"num")){Data({data:fData,param:"nol_highWM",val:bJ});}
calculateTriggers(bJ,fData);Data({data:fData,param:"nol_davState",val:"1"});break;case"49":case"setplayheadposition":case"playheadposition":if(bJ>-1){if(Data({data:fData,param:"nol_onCompleteFired"})===true){$._listeners.fireEvent("flushPauseEventQueue");}
if(Data({data:fData,param:"nol_disabled"})==="true"||!bJ||Data({data:fData,param:"nol_timer"})!=="nol_cmsoffset"||(fData._currVidType==="ad"&&Data({data:fData,param:"nol_product"})==="dcrvideo"&&Data({data:fData,param:"nol_cadence"})==="impression")){return;}
if(typeof bJ!=="number"){if(typeof bJ==="string"){bJ=cast(bJ,"num");}else{return;}}
Data({data:fData,param:"nol_isLive",val:(bJ>86400).toString()});_du=cast(Data({data:fData,param:"nol_highWM"}),"num");if(_du<bJ){Data({data:fData,param:"nol_highWM",val:bJ});}
if(!fData.serviceFlag.stn.need){calculateTriggers(bJ,fData);}else{Data({data:fData,param:"nol_queueTime",val:bJ});callService(fData,{service:"stn",key:Data({data:fData,param:"nol_assetid"}),url:Data({data:fData,param:"nol_stationURL"})});}
Data({data:fData,param:"nol_davState",val:"1"});}else{if(dN.timeStamp&&!_errorSent[dN.timeStamp]){sendError(fData,{type:15,msg:'A negative playhead position was sent and will be ignored.'});_errorSent[dN.timeStamp]=true;}
$._listeners.fireEvent("warn",{type:"warn",msg:"Warning: A negative playhead position was sent and will be ignored."});}
break;case"55":case"sendid3":if(typeof bJ==="object"&&bJ.length>0){for(j=0;j<bJ.length;j+=1){if(bJ[j].key&&bJ[j].key==="PRIV"){bJ=bJ[j].info;break;}}}
aa=bJ.toString();aC=aa.split("/");bJ={};if(aC.length<cast(bA.nol_breakout,"num")){return;}
for(_s in bA){if(bA.hasOwnProperty(_s)){bJ[_s]=aC[bA[_s]];if(_s==="nol_breakout"){bJ[_s]=aC[cast(bA[_s],"num")].substr(0,2);}
preDataObj[_s]=bJ[_s];}}
if(!bJ||(Data({data:fData,param:"nol_tsvBreakoutMap"})&&Data({data:fData,param:"nol_tsvBreakoutMap"}).enable.indexOf(bJ.nol_breakout)===-1)||bJ.nol_nWebAddress.indexOf("nielsen.com")===-1||(bJ.nol_fdcid===Data({data:fData,param:"nol_cidNull"})&&bJ.nol_pccid===Data({data:fData,param:"nol_cidNull"}))){return;}
fData._currVidType="content";for(i=0,j=enableFilterMap.length;i<j;i+=1){pointer=cmsMap[enableFilterMap[i]]?cmsMap[enableFilterMap[i]].clientField:enableFilterMap[i];preDataObj[enableFilterMap[i]]=bJ[pointer]||Data({data:fData,param:enableFilterMap[i]});}
preDataObj.nol_vidtype="content";cG(fData,l_eventFilter.onId3Detected,preDataObj);if(preDataObj.nol_disabled!=="false"||Data({data:fData,param:"nol_timer"})==="nol_cmsoffset"){return;}
if(Data({data:fData,param:"nol_cadence"})==="daypart"){var l_currAssetid=Data({data:fData,param:"nol_assetid"});if(!l_currAssetid&&bJ.nol_fdcid&&bJ.nol_fdcid!==Data({data:fData,param:"nol_cidNull"})){fData._currAssetid=bJ.nol_fdcid;}else if(!fData._currAssetid&&l_currAssetid){fData._currAssetid=l_currAssetid;}}
bJ.nol_ac=fData._currVidType;bJ.nol_assetid=Data({data:fData,param:"nol_assetid"})||fData._currAssetid;if((Data({data:fData,param:"nol_subTag"})||Data({data:fData,param:"nol_product"})==="id3")&&bJ.nol_pccid!==Data({data:fData,param:"nol_cidNull"})&&bJ.nol_pccid!==Data({data:fData,param:"nol_pccid"})){bm.filters.onId3PcCidChanged=true;bm.count+=1;}
if(!Data({data:fData,param:"nol_subTag"})&&bJ.nol_fdcid!==Data({data:fData,param:"nol_cidNull"})&&bJ.nol_fdcid!==Data({data:fData,param:"nol_fdcid"})){if(_id3Count>0&&Data({data:fData,param:"nol_product"}).indexOf("id3")!==-1){cJ(fData);}
bm.filters.onId3FdCidChanged=true;bm.count+=1;}
if(bm.count){init(fData,"sendID3",bJ);if((bm.filters.onId3FdCidChanged||Data({data:fData,param:"nol_fdcid"})==Data({data:fData,param:"nol_cidNull"}))&&Data({data:fData,param:"nol_tsvBreakoutMap"}).enable.indexOf(bJ.nol_breakout)!==-1){fData.serviceFlag.tsv.need=true;}
if(bm.count>0){for(_s in bm.filters){if(bm.filters[_s]){cG(fData,l_eventFilter[_s]);if(Data({data:fData,param:"nol_disabled"})==="true"){return;}}}}
if(l_eventFilter.onComplete){cG(fData,l_eventFilter.onComplete);if(Data({data:fData,param:"nol_disabled"})==="true"){return;}}}else{for(_s in bJ){if(bJ.hasOwnProperty(_s)){Data({data:fData,param:_s,val:bJ[_s]});}}}
Data({data:fData,param:"nol_id3Raw",val:aa});if(fData.serviceFlag.tsv.need&&tsvProducts.indexOf("|"+Data({data:fData,param:"nol_product"})+"|")!==-1){tsvKey=bm.onId3PcCidChanged===true?Data({data:fData,param:"nol_pccid"}):Data({data:fData,param:"nol_fdcid"});callService(fData,{service:"tsv",key:tsvKey,url:Data({data:fData,param:"nol_tsvURL"})});}
if(Data({data:fData,param:"nol_product"})==="id3"&&(bJ.nol_watermark&&String(bJ.nol_watermark).length>0)){wmRaw=Data({data:fData,param:"nol_id3Data"});ah=Math.round((getTIme()/1000)+l_timeOffset);id3Seq=Data({data:fData,param:"nol_id3Seq"})||0;if(wmRaw){Data({data:fData,param:"nol_id3Data",val:wmRaw+="|"+ah+","+Data({data:fData,param:"nol_id3Raw"})});}else{Data({data:fData,param:"nol_id3Data",val:id3Seq+":"+Data({data:fData,param:"nol_clocksrc"})+":"+Data({data:fData,param:"nol_tsvFlag"})+":"+ah+","+Data({data:fData,param:"nol_id3Raw"})});Data({data:fData,param:"nol_id3Seq",val:cast(id3Seq,"num")+1,vidType:"content"});}
if(_id3Count>0){cJ(fData,{aR:true});}
_id3Count+=1;Data({data:fData,param:"nolPriv_id3Count",val:_id3Count});Data({data:fData,param:"nol_davState",val:"1"});return;}
bn=Data({data:fData,param:Data({data:fData,param:"nol_timer"})})||Data({data:fData,param:"nol_fdoffset"});if(Data({data:fData,param:"nol_cadence"})==="daypart"){bn=cast(bn,"num");bn+=Data({data:fData,param:"nol_timer"})=="nol_pcoffset"?cast(Data({data:fData,param:"nol_pcTimeCode"}),"num"):cast(Data({data:fData,param:"nol_fdTimeCode"}),"num");}
if(!fData.serviceFlag.tsv.need){if(Data({data:fData,param:"nol_disabled"})==="true"){return;}
calculateTriggers(bn,fData);Data({data:fData,param:"nol_davState",val:"1"});}else{Data({data:fData,param:"nol_queueTime",val:bn});}
break;case'60':case'mute':break;default:break;}
ggpmPostProc(fData,preProcData);};function addDataObj(fData){var l_outObject,nextLowest=null,l_limit=fData._currVidType=='content'?cast(Data({data:fData,param:"nol_chnlCountThrshld"}),"num")||defaultTimelineSize:cast(Data({data:fData,param:"nol_staticCountThrshld"}),"num")||defaultTimelineSize,l_dataObj=fData._dataArrObj[fData._currVidType],_s,l_objTS=0,maxCount=fData._dataArrObj.count;if(!fData._dataArrObj[fData._currVidType].hasOwnProperty(fData._currAssetid)){if(maxCount[fData._currVidType]>=l_limit){for(_s in l_dataObj){if(l_dataObj.hasOwnProperty(_s)){l_objTS=l_dataObj[_s].nolPriv_priority;if(l_objTS<=0){l_outObject=_s;break;}
if(nextLowest===null||nextLowest>l_objTS){nextLowest=l_objTS;l_outObject=_s;}}}
if(l_dataObj.hasOwnProperty(l_outObject)){delete l_dataObj[l_outObject];maxCount[fData._currVidType]-=1;}}
fData._dataArrObj[fData._currVidType][fData._currAssetid]={nolPriv_priority:0};maxCount[fData._currVidType]+=1;}};function resetDataObj(fData,resetStatic){if(typeof resetStatic!=='undefined'&&resetStatic===true){fData._dataArrObj.static={};}
fData._dataArrObj.ad={};fData._dataArrObj.content={};fData._dataArrObj.count={content:0,ad:0,static:0};fData._currAssetid="0";};function populateOttStatus(fData){try{var l_playerId=Data({data:fData,param:"nol_playerId"});if(l_playerId&&$._players&&$._players.hasOwnProperty(l_playerId)){var player=$._players[l_playerId];if(player&&Object.keys(player.ottStatusObj).length>0){var l_key;for(l_key in player.ottStatusObj){Data({data:fData,param:l_key,val:player.ottStatusObj[l_key],vidType:"content"});}}}}catch(e){$._listeners.fireEvent("error",{type:"error",msg:"Error in populateOttStatus"+e});}};function init(fData,evnt,_param){var _c3="",_s,i,savedVals="nol_minutes, nol_tagPresence, nol_pingCount, nol_currSeg, nol_segmentTimeSpent, nol_cumeTimeSpent, nol_count",_data=Data({data:fData,param:{}}),breakout,defaultData,l_playerId=Data({data:fData,param:"nol_playerId"});addDataObj(fData);if(fData._currVidType.toLowerCase()==="ad"){_c3="st,a";Data({data:fData,param:"nol_currSeg",val:'0'});}
if(Data({data:fData,param:"nol_errorURL"})===''){Data({data:fData,param:"nol_errorURL",val:au+dp+dprErrorAPI+"?message=|![nol_errorMessage]!|"});}
if(evnt==="loadMetadata"){for(_s in _data){if(_data.hasOwnProperty(_s)&&savedVals.indexOf(_s)===-1){Data({data:fData,param:_s,val:settings({data:fData,param:_s})||""});}}}
for(_s in _param){if(_param.hasOwnProperty(_s)){Data({data:fData,param:String(_s),val:String(_param[_s])});}}
Data({data:fData,param:"nolPriv_sendData",val:true});Data({data:fData,param:"nol_davState",val:"0"});Data({data:fData,param:"nol_highWM",val:"0"});Data({data:fData,param:"nol_iagData",val:""});Data({data:fData,param:"nol_disabled",val:"false"});Data({data:fData,param:"nol_sendQual",val:settings({data:fData,param:"nol_sendQual"})||""});if(!Data({data:fData,param:"nol_c3"})){Data({data:fData,param:"nol_c3",val:_c3});}
if(fData._currVidType.toLowerCase()==="content"&&Data({data:fData,param:"nol_cadence"})==="impression"){if(R&&R.hasOwnProperty(l_playerId)&&!R[l_playerId].hasOwnProperty("nol_sessionId")){R[l_playerId]["nol_sessionId"]=getTIme();}}
if((!Data({data:fData,param:"nol_minutes"}))||(Data({data:fData,param:"nol_cadence"})!=="daypart"&&Data({data:fData,param:"nol_product"})!=="dcrstatic")||(Data({data:fData,param:"nol_product"})==="dcrstatic"&&Data({data:fData,param:"nol_cadence"})==="stream")){var mins=cS(Data({data:fData,param:"nol_segmentLength"}));Data({data:fData,param:"nol_minutes",val:mins});Data({data:fData,param:"nol_pingCount",val:0});Data({data:fData,param:"nol_duration",val:new Array(mins.length+1).join('0')});}
populateOttStatus(fData);};function Tag(ae,player){var l_playerId=ae.playerId,l_urls=R[l_playerId].nol_tagMap.nol_url,i,l,_s,dM=0,_configString=l_urls?l_urls[ae.nol_url]||ae.nol_url||"":ae.nol_url||"",serviceFlag={stn:{need:false,callback:"nol_stnevt"},tsv:{need:false,callback:"nol_tsvevt"}},_dataArrObj={ad:{},content:{},static:{},count:{content:0,static:0}},_settingsDefault={nol_disabled:"true",nol_errorMessage:"none",nol_vidtype:"",nol_muteState:"0",nol_volumeLevel:"100",nol_clockSource:"D",nol_aggregate:"1",nol_pingCount:"0",nol_intrvlThrshld:"90",nol_id3IntrvlGp:"15",nolPriv_sendData:true,nol_timer:"nol_fdoffset",nol_isLive:"false",nolPriv_errorSent:"",nolPriv_id3Count:0,nolPriv_cmsMap:{},nol_timeSpentViewing:{ad:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},content:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},static:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0}},nol_enableFilterMap:["nol_vidtype","nol_tagSrc","nol_linearAdLoadFlag","nol_ac"],nol_xorSeed:"N!3ls3nBL",nol_currSeg:"0",nol_minWonOverride:"0",nol_customExtension:["nol_legacyCustom"],nol_pingCreationTime:"0",nol_pingSendTime:"0",nol_clientUrl:window.location.href,nol_sendTime:"0",nol_pageURL:window.location.href.replace(/\"/g,"").replace(/\'/g,"").replace(/%27/g,"").replace(/%22/g,""),nol_referrerURL:window.document.referrer.replace(/\"/g,"").replace(/\'/g,"").replace(/%27/g,"").replace(/%22/g,""),nol_ottStatus:"0",nol_ottType:"none",nol_ottDevice:"NA",nol_ottDeviceName:"NA",nol_ottDeviceID:"NA",nol_ottDeviceManufacturer:"NA",nol_ottDeviceModel:"NA",nol_ottDeviceVersion:"NA"},_settings=ae,fData={_dataArrObj:_dataArrObj,_settings:_settings,_currVidType:"ad",_currAssetid:"0",serviceFlag:serviceFlag};$._listeners.addListener("tick",function(){if(player.pauseObj.eventPauseTime>=player.pauseObj.cmsPauseTime&&_playerController.state.status.current(fData)!==_playerController.states.stopped&&_playerController.state.status.current(fData)!==_playerController.states.paused){if(_eventDataController.isEnabled(fData)){var inferredEvent={event:_eventsController.events.pause,curPos:_playerController.state.position.current(fData),prevPos:null,timestamp:_playerController.state.timeStamp.current(fData)};_playerController.state.set(fData,inferredEvent);_eventDataController.preProcess(fData,inferredEvent);player.pauseObj.eventPauseTime=0;}}
if((player.pauseObj.pauseTime>player.pauseObj.maxPauseTime)&&(Data({data:fData,param:"nol_product"})!=='dcrstatic')){player.pauseObj.pauseTime=0;$._listeners.fireEvent("handleSessionReset",{plid:l_playerId,passedFdata:fData});$._listeners.fireEvent("debug",{type:"debug",msg:"Max pause time reached. Just fired handleSessionReset."});}});resetDataObj(fData);for(_s in _settingsDefault){if(ae.hasOwnProperty(_s)){_settings[_s]=ae[_s];}else{_settings[_s]=R[_settings.playerId][_s]||_settingsDefault[_s];}}
if(_settings.nol_customExtension&&_configString){for(i=0,l=_settings.nol_customExtension.length;i<l;i+=1){_configString=_configString.replace("|!["+_settings.nol_customExtension[i]+"]!|",R[_settings.playerId][_settings.nol_customExtension[i]]||"")}
_settings.nol_url=_configString;}
if(Data({data:fData,param:"nol_fireStop"})==="true"||"interval,episode,streamduration".indexOf(Data({data:fData,param:"nol_cadence"}))!==-1){bindEvent("pagehide||beforeunload",function(dN){if(sendInterval){window.clearInterval(sendInterval);sendInterval=0;sendSyncData({serverTimeOffset:Data({data:fData,param:"nolPriv_serverTimeOffset"}),url:"__sendIt",maskRef:Data({data:fData,param:"nol_rfrmsk"})});}
if("sendBeacon"in navigator){USEBEACON=true;}
_eventDataController.setNextTick(fData,null,'content');checkStop(fData);});}
this.eventListener=function(e){cA(fData,e);};if(R[l_playerId].aV.length>dM){for(i=0;i<R[l_playerId].aV.length;i+=1){if(R[l_playerId]&&R[l_playerId].aV){R[l_playerId].aV[i].timeStamp='queued'+i;}
cA(fData,R[l_playerId].aV[i]);dM=i;}}};function handleConfigRequest(args){if(args&&args.hasOwnProperty("configReq")&&args.hasOwnProperty("player")&&args.configReq.length>0&&typeof args.player!=='undefined'){cs(args.configReq);window.clearInterval(args.player.lsPopulatedInterval);args.player.lsPopulatedInterval=0;}else{$._listeners.fireEvent("error",{type:"error",msg:"Error in handleConfigRequest. Args is null or missing configReq or player."});}};PLDPR.initFromConfig=function(t){$._listeners.fireEvent("info",{type:"info",msg:"Recieved config response."});try{if(t&&t.nol_GLOBALS){var ag,player,now=getTIme(),i,j,k,l,_debugURL="localhost",_debugCodes=t.nol_GLOBALS.debugSfcode||"uat-cert",_debugApid=t.nol_GLOBALS.nol_appid||"",l_passedLsId=t.nol_GLOBALS.nol_lsid||"",l_emmUrl=t.nol_GLOBALS.nol_emmURL||"",hybridCall,l_tempStr,l_clientField,l_cmsMapObj,l_encoding,extension,extensionStr,l_serverTime;if(l_passedLsId!==""&&l_emmUrl!==""){$.setLsId(l_passedLsId,l_emmUrl);}else if($.localStorageId===''&&l_passedLsId!==''){$.setLsId(l_passedLsId);}
$._listeners.fireEvent("sendOptOutStatus",(l_passedLsId=="OPTOUT"));if(t&&t.hasOwnProperty("nol_GLOBALS")){var l_playerId=t.nol_GLOBALS.nol_playerId||0;player=$._players[l_playerId];if(!player)
return;_debugURL=t.nol_GLOBALS.nol_sfcode||_debugURL;player.pauseObj={pauseTime:0,eventPauseTime:0,maxPauseTime:(t.nol_GLOBALS.nol_pauseTimeout||1800),cmsPauseTime:(t.nol_GLOBALS.nol_pauseEventTimeoutPlayhead||15)};if($.localStorage){l_serverTime=R[l_playerId]?R[l_playerId].nol_serverTime||$.localStorage.getItem("nol_serverTime"):$.localStorage.getItem("nol_serverTime")||0;}else{l_serverTime=R[l_playerId]?R[l_playerId].nol_serverTime:0;}
if(l_serverTime===t.nol_GLOBALS.nol_serverTime){timeOffset=R[l_playerId]?R[l_playerId].nolPriv_serverTimeOffset:t.nol_GLOBALS.nol_serverTime-Math.round(now/1000)}else{timeOffset=t.nol_GLOBALS.nol_serverTime-Math.round(now/1000);if($.localStorage){$.localStorage.setItem("nol_serverTime",t.nol_GLOBALS.nol_serverTime);}}
errorWait=t.nol_GLOBALS.nol_errorWait||errorWait;ag=player.getConfigParams().ggParams||{};R[l_playerId]=populateData(R[l_playerId]);R[l_playerId].nolPriv_serverTimeOffset=timeOffset;if(sendInterval){window.clearInterval(sendInterval);sendInterval=0;}
if(t.nol_GLOBALS.nol_sendTimer){sendInterval=window.setInterval(function(){sendSyncData({serverTimeOffset:R[l_playerId].nolPriv_serverTimeOffset,url:"__sendIt"});},t.nol_GLOBALS.nol_sendTimer*1000);}
for(i in ag){if(ag.hasOwnProperty(i)){R[l_playerId][i]=ag[i];}}
for(i in t.nol_GLOBALS){if(t.nol_GLOBALS.hasOwnProperty(i)){R[l_playerId][i]=t.nol_GLOBALS[i];}}
l_eventFilter=R[l_playerId].nol_eventFilter||{};l_serviceFilter=R[l_playerId].nol_serviceFilter||{};bA=R[l_playerId].nol_id3Map||{};for(i in R[l_playerId].nol_clientCMSmap){if(R[l_playerId].nol_clientCMSmap.hasOwnProperty(i)){l_tempStr=R[l_playerId].nol_clientCMSmap[i].toString()||"";l_clientField=l_tempStr.replace(cmsMapRegex,"");l_encoding=l_tempStr.match(cmsMapRegex)||[];l_cmsMapObj={clientField:l_clientField.toString(),encoding:l_encoding.join("")};cmsMap[i]=l_cmsMapObj;}}
if(t.nol_GLOBALS.hasOwnProperty("nol_maxStaticInstances")&&ns.hasOwnProperty("setTotalNumAssetsAllowed")){ns.setTotalNumAssetsAllowed(t.nol_GLOBALS["nol_maxStaticInstances"]);}
R[l_playerId].nol_lstrg="lstrg-"+l_passedLsId;}
if(t&&t.hasOwnProperty("nol_TAGS")){R[l_playerId].tagSize=t.nol_TAGS.length;R[l_playerId].tags=[];$._listeners.fireEvent("debug",{type:"debug",msg:"NIELSEN TAGS EXPECTED TO FIRE:"});for(i=0;i<R[l_playerId].tagSize;i+=1){$._listeners.fireEvent("debug",{type:"debug",msg:String(t.nol_TAGS[i].nol_comment)});t.nol_TAGS[i].playerId=t.nol_TAGS[i].playerId||l_playerId;R[l_playerId].tags.push(new Tag(t.nol_TAGS[i],player));}}
if($.enablePlayer!==undefined){$.enablePlayer(l_playerId,"PLDPR");}
R[l_playerId].bReInit=false;if(ag.nol_hybridCfg&&window&&window.JSON){hybridCall=window.document.createElement("script");hybridCall.text="(function() {if (typeof "+ag.nol_hybridCfg+" === 'function'){"+ag.nol_hybridCfg+"('"+JSON.stringify(t)+"')}}())";if(window.document.head){window.document.head.appendChild(hybridCall);window.document.head.removeChild(hybridCall);}else{window.document.getElementsByTagName('head')[0].appendChild(hybridCall);window.document.getElementsByTagName('head')[0].removeChild(hybridCall);}}
$._listeners.addListener("tick",function(){if(player&&player.hasOwnProperty("pauseObj")&&player.pauseObj.hasOwnProperty("pauseTime")){player.pauseObj.pauseTime+=1;player.pauseObj.eventPauseTime+=1;}});$._listeners.fireEvent("flushQueue");}else{if(window.console&&window.console.warn){window.console.warn("Warning: CMS config response is not valid. Please ensure NOL global parameter values are correct.");}
$._listeners.fireEvent("warn",{type:"warn",msg:"Warning in initFromConfig. NOL global parameters are not valid."});}}catch(e){if(window.console&&window.console.error){window.console.error("Error initializing CMS config response. Please ensure NOL global parameter values are correct.");}
$._listeners.fireEvent("error",{type:"error",msg:"Error in initFromConfig. Error parsing config response."});}};PLDPR.init=function(player){var ag=player.getConfigParams()||{},i,strippedAddr,l_lsid=$.getIfLsidShouldSend()?$.getLsId():undefined,defaultConfig,configParams="",l_addrProtocol=au.indexOf("https")===0?"https":"http",l_playerId=ag.playerId||0;defaultConfig={pli:{val:l_playerId,protect:true},nmspc:{val:"NOLCMB",protect:true},sdkv:{val:sdkVersion,protect:true},fmt:{val:"jsonp",protect:true},apn:{val:"Tester",protect:false},fbtag:{val:"true",protect:false},cfgv:{val:configVersion,protect:true},bldv:{val:BUILDVERSION,protect:true},prefprotocol:{val:l_addrProtocol,protect:false}};player.addListener("ggPM",function(e){dI(e);});player.lsPopulatedInterval=0;player.lsCurrentRetry=0;player.serviceSending={tsv:false,stn:false};player.ottStatusObj={};player.oServiceCall={};for(i in ag.ggParams){if(ag.ggParams.hasOwnProperty(i)&&(!defaultConfig[i]||!defaultConfig[i].protect)&&i.indexOf("nol_")!=0){defaultConfig[i]={val:encodeVal(ag.ggParams[i])};}}
for(i in defaultConfig){if(defaultConfig.hasOwnProperty(i)){configParams+=i+"="+defaultConfig[i].val+"&";}}
configParams=configParams.substr(0,configParams.length-1);strippedAddr=au.replace(/[\w\W]*?:\/\//g,'');if(l_lsid!==undefined&&!player.lsPopulatedInterval){player.lsPopulatedInterval=window.setInterval(function(){l_lsid=$.getLsId();if(l_lsid!=="-1"){configAddr=l_addrProtocol+"://"+strippedAddr+dp+dprConfigAPI+"?"+configParams+"&lsid="+l_lsid+"&sendTime="+Math.floor(getTIme()/1000);handleConfigRequest({configReq:configAddr,player:player});}else if(player.lsCurrentRetry===lsRetryMax){configAddr=l_addrProtocol+"://"+strippedAddr+dp+dprConfigAPI+"?"+configParams+"&lsid=999"+"&sendTime="+Math.floor(getTIme()/1000);handleConfigRequest({configReq:configAddr,player:player});}else{player.lsCurrentRetry+=1;}},1000);}else if(l_lsid===undefined){configAddr=l_addrProtocol+"://"+strippedAddr+dp+dprConfigAPI+"?"+configParams+"&sendTime="+Math.floor(getTIme()/1000);handleConfigRequest({configReq:configAddr,player:player});}};if(!PLDPR.built){PLDPR.built=true;PLDPR.BUILDVERSION=BUILDVERSION;$.bindPlayers(PLDPR,"PLDPR");$._listeners.fireEvent("flushQueue");}
return PLDPR;});