(function($,window){if($.isBuilt&&$.isBuilt())return;var webProtocol=window.location.protocol||"http:",addressPrefix="//secure-",cdnPrefix=window.location.protocol==="https:"?"//sec":"//",baseaddr=".imrworldwide.com/",configGlobalFile="glcfg510.js",configGlobalVer="510",scriptsArr={head:document.getElementsByTagName('head')[0].getElementsByTagName('script'),body:document.getElementsByTagName('script')},cdnAddress=getCdnAddress(),collectionAddress="http://secure-us.imrworldwide.com/",defaultNielsenDomain="imrworldwide.com",cacheBusterRefreshMilliseconds=86400000,__instance=$.getInstances?$.getInstances():{},maxNumberOfAssetInstances=1,numSecToUpdateAssets=5,startGlobalTime=0,currentGlobalTime=0,currentGlobalSeconds=0,isBuilt=false,optOutStatus=false,BUILDVERSION="5.1.0.24";Date.now=Date.now||function(){return+new Date;};$.isBuilt=function(){return isBuilt;};$.getInstance=function(passedName){var name=(typeof passedName!=='undefined'&&(typeof passedName=="string"||typeof passedName=="object"&&passedName.constructor===String))?passedName:"default";if(!__instance.hasOwnProperty(name)){__instance[name]=CMB(name);}return __instance[name];};$.setTotalNumAssetsAllowed=function(val){maxNumberOfAssetInstances=isNaN(val)?val:parseInt(val,10);};$.getAddress=function(){return cdnAddress;};$.getConfigAddress=function(){return collectionAddress;};$.getInstances=function(){return __instance;};$.loadXmlString=function(txt){try{var xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(txt);return(xmlDoc);}catch(e){try{var parser=new DOMParser();xmlDoc=parser.parseFromString(txt,"text/xml");return(xmlDoc);}catch(e){}}return(null);};$.isNielsenTag=function(url){var retVal=false;if(typeof(url)!=="undefined"){var index1=url.indexOf("?"),index2=url.indexOf(defaultNielsenDomain);if(index2> -1&&index2<index1){retVal=true;}}return retVal;};$.getVersion=function(){return configGlobalVer;};$.send=function(element){if(element&&window.console&&window.console.log){console.log(element.parentNode);}};$.browserSafeAddEventListener=function(obj){if(typeof(obj.element)!=="undefined"){if(obj.element.addEventListener){obj.element.addEventListener(obj.eventType,obj.func,obj.useCapture);}else if(obj.element.attachEvent){obj.element.attachEvent("on"+obj.eventType,obj.func);}}};$.browserSafeRemoveEventListener=function(obj){if(obj!=undefined&&obj!=null&&obj.element!=null&&obj.element!=undefined){if(obj.element.removeEventListener){obj.element.removeEventListener(obj.eventType,obj.func,obj.useCapture);}else if(obj.element.detachEvent){obj.element.detachEvent("on"+obj.eventType,obj.func);}}};function getCdnAddress(){var scriptObj,cdnVal;for(var i in scriptsArr){scriptObj=scriptsArr[i];for(var j in scriptObj){cdnVal=scriptObj[j];if(cdnVal&&cdnVal.hasAttribute&&cdnVal.hasAttribute("src")&&cdnVal.src.indexOf(baseaddr)!== -1){if(cdnVal&&cdnVal.src.indexOf(baseaddr)!== -1&&cdnVal.src.indexOf("ggcmb5")!== -1){return cdnVal.src.substring(0,cdnVal.src.indexOf(baseaddr)+baseaddr.length);}}}}return((typeof webProtocol!=='undefined')&&(typeof cdnPrefix!=='undefined')&&(typeof baseaddr!=='undefined'))?(webProtocol+cdnPrefix+"cdn-gl"+baseaddr):"https://seccdn-gl.imrworldwide.com/";};function setOptOutStatus(evt){if(evt&&evt.hasOwnProperty("target")){optOutStatus=(String(evt.target).toLowerCase()==='true');}};function globalTickUpdate(){currentGlobalTime=Date.now();currentGlobalSeconds=Math.ceil((currentGlobalTime-startGlobalTime)/1000);};function emitAssetEvents(evt){if(evt&&evt.hasOwnProperty("target")&& !isNaN(evt.target)){for(var i in __instance){(function(instanceId){var l_cmb=__instance[instanceId];if(l_cmb===undefined|| !l_cmb.hasOwnProperty("staticPage")|| !l_cmb.staticPage.hasOwnProperty("evtParams"))return;var l_obj=l_cmb.staticPage.evtParams;if(l_obj.param1.type==="static"){l_cmb.ggPM("48",evt.target,"","","");}})(i);}}};function CMB(passedName){var config,configParams,listeners={},ggEventQue=[],ggPauseEventQue={},_id=String(Date.now())+Math.round(Math.random()*10000),container;var self={name:passedName,initialized:false,staticPage:{},modules:{allModInit:false},configLoaded:false};function releaseAsset(asset){if(!self.staticPage.hasOwnProperty("evtParams"))return;self.ggPM("56",self.staticPage.evtParams.param1,self.staticPage.evtParams.param2,self.staticPage.evtParams.param3,self.staticPage.evtParams.param4);};function fireEvent(event,paramObj){if(typeof event=="string"){event={type:event};}if(!event.target){event.target=paramObj;}if(!event.type){throw new Error("Event object missing 'type' property.");}if(listeners[event.type]instanceof Array){var localListeners=listeners[event.type];for(var i=0,len=localListeners.length;i<len;i++){localListeners[i].call(self,paramObj);}}};function retrieveMeta(args){var retErr="Error in retrieveMeta";if(args&&args.hasOwnProperty("fData")&&args.hasOwnProperty("ad")&&args.hasOwnProperty("content")&&args.hasOwnProperty("static")){for(var i in args.fData){for(var j in args.fData[i][0]){if(String(j).indexOf("nol_")=== -1){args[i][j]=args.fData[i][0][j];}}}return args;}else if(args&&args.hasOwnProperty("err")){args.err=retErr+": Missing passedFdata, Ad, content or static properties";return args;}return{err:retErr};};function setupCmbListeners(global){if(global){global.registerListener("ggPM",self);if(global._listeners){global._listeners.addListener("updateCmbStaticPage",self.handleUpdateOfStatic);global._listeners.addListener("removeCmbAssetId",self.removeAsset);global._listeners.addListener("tick",function(){globalTickUpdate();fireEvent("globalTick",{time:currentGlobalTime,seconds:currentGlobalSeconds});});global._listeners.addListener("dcrHeartbeat",emitAssetEvents);global._listeners.addListener("flushQueue",self.emptyQueue);global._listeners.addListener("handleSessionReset",self.handleSessionReset);global._listeners.addListener("flushPauseEventQueue",self.flushPauseEventQueue);global._listeners.addListener("sendOptOutStatus",setOptOutStatus);}$.GLCFG=global;}};self.getOptOutStatus=function(){return optOutStatus;};self.getId=function(){return _id;};self.GetName=function(){return self.name;};self.Initialized=function(val){if(typeof val!=='undefined'){self.initialized=val;}else{return self.initialized;}};self.removeAsset=function(paramObj){if(typeof paramObj!=='undefined'&&paramObj.target.param1.hasOwnProperty("assetid")){self.staticPage={};}};self.handleUpdateOfStatic=function(paramObj){if(paramObj&&paramObj.target){var l_parObj=paramObj.target.evtInfo;if($.GLCFG&&$.GLCFG.PLDCR&&typeof l_parObj!=='undefined'&&l_parObj.param1.hasOwnProperty("assetid")&&self.getId()===paramObj.target.plid){var currTick=$.GLCFG.PLDCR.latestDcrTick();if(Object.keys(self.staticPage).length!==0&&self.staticPage.hasOwnProperty("id")&&self.staticPage.id===l_parObj.param1.assetid&&self.staticPage.hasOwnProperty("lastTimeStamp")){self.staticPage.lastTimeStamp=currTick;}else{self.staticPage={id:l_parObj.param1.assetid,evtParams:l_parObj,startTimeStamp:currTick,lastTimeStamp:currTick};}}}};self.addListener=function(type,listener){if(listener){if(typeof listeners[type]=="undefined"){listeners[type]=[];}listeners[type].push(listener);}};self.removeListener=function(type,listener){if(self._listeners[type]instanceof Array){var localListeners=listeners[type];for(var i=0,len=localListeners.length;i<len;i++){if(localListeners[i]===listener){localListeners.splice(i,1);break;}}}};self.handleSessionReset=function(args){if(args&&args.target&&args.target.hasOwnProperty("plid")&&_id===args.target.plid&&args.target.hasOwnProperty("passedFdata")&&args.target.passedFdata.hasOwnProperty("_dataArrObj")&&args.target.passedFdata._dataArrObj){var l_eventData={fData:args.target.passedFdata._dataArrObj,content:{},ad:{},static:{},err:0};if(retrieveMeta(l_eventData).err===0&&args.target.passedFdata.hasOwnProperty("_currVidType")){var l_currVidType=args.target.passedFdata._currVidType,l_staticUsed=(Object.keys(l_eventData.static).length>0),l_contentUsed=(Object.keys(l_eventData.content).length>0),l_adUsed=(Object.keys(l_eventData.ad).length>0);if(l_contentUsed||l_adUsed){self.ggPM("57","1","","","");if(l_contentUsed&& !ggPauseEventQue.hasOwnProperty("content")){ggPauseEventQue.content={evt:"pauseloadmeta",meta:l_eventData.content,plid:args.target.plid};}}}else{}}if(self._listeners&&self._listeners.fireEvent){self._listeners.fireEvent("debug",{type:"debug",msg:"Fired handleSessionReset from ggcmb."});}};self.flushPauseEventQueue=function(){if(Object.keys(ggPauseEventQue).length<=0){return;}if(self.modules.PLDPR){var ndx;for(ndx in ggPauseEventQue){fireEvent("ggPM",{evtInfo:{eventType:ggPauseEventQue[ndx].evt,param1:ggPauseEventQue[ndx].meta},id:_id});}ggPauseEventQue={};}if(self._listeners&&self._listeners.fireEvent){self._listeners.fireEvent("debug",{type:"debug",msg:"Fired flushPauseEventQueue from ggcmb."});}};self.ggPM=function(func,_param1,_param2,_param3,_param4){if(!self.initialized){return;}if(func!==undefined&&func!==null&&func!==''){var paramObj={};paramObj.eventType=func;paramObj.param1=_param1;paramObj.param2=_param2;paramObj.param3=_param3;paramObj.param4=_param4;if(self.modules.allModInit&&(self.modules.PLCMB==2||self.modules.PLDPR==2)){self.emptyQueue();fireEvent("ggPM",{evtInfo:paramObj,id:_id});}else{ggEventQue.push(paramObj);}}};self.getConfigParams=function(){return configParams;};self.emptyQueue=function(){if(ggEventQue.length<=0){return}if(self.modules.allModInit&&(self.modules.PLCMB||self.modules.PLDPR)){for(var i=0,len=ggEventQue.length;i<len;i+=1){fireEvent("ggPM",{evtInfo:ggEventQue[i],id:_id});}ggEventQue=[];}};self.getContainer=function(){return container;};self.ggInitialize=function(_ggParams,_instanceName,_uid,_oldFlashDetect,_detectBrowser,_container){var fxml,xn,lim,sfCode="us",cdnDomain="cdn-gl";container=_container;configParams={ggParams:_ggParams,uid:_uid,oldFlashDetect:_oldFlashDetect,detectBrowser:_detectBrowser,playerId:_id};if(typeof _ggParams==typeof String()){fxml=$.loadXmlString("<vi>"+_ggParams+"</vi>");xn=fxml.firstChild.firstChild;lim=0;_ggParams={};while(xn!=undefined&&lim<20){if(xn.firstChild!=null){_ggParams[xn.nodeName]=xn.firstChild.nodeValue;}xn=xn.nextSibling;lim++;}configParams.ggParams=_ggParams;};self.Initialized(true);configGlobalVer=_ggParams.nsdkv||configGlobalVer;sfCode=_ggParams.sfcode||sfCode;collectionAddress=_ggParams.coreaddress||webProtocol+addressPrefix+sfCode+baseaddr;$.loadLib("GLCFG",cdnAddress+"novms/js/2/configs/"+configGlobalFile,$,setupCmbListeners);};$.browserSafeAddEventListener({element:window,eventType:"beforeunload",useCapture:false,func:function(e){if(self&&self.staticPage){releaseAsset(self.staticPage);}}});return self;}(function(){var libs={};$.loadLib=function(name,url,parent,callback){if(name!==undefined&&name!==null&&typeof name==='string'&&url!==undefined&&url!==null&&typeof url==='string'){if(libs[name]){if(libs[name].body){callback(libs[name].body(parent));return;}libs[name].callbacks.push({func:callback,arg:parent});}else{libs[name]={callbacks:[]};libs[name].callbacks.push({func:callback,arg:parent});var script=window.document.createElement("script");script.async=true;script.src=url;window.document.getElementsByTagName('head')[0].appendChild(script);}}};$.registerLib=function(name,body){try{if(libs&&libs.hasOwnProperty(name)){var lib=libs[name];lib.body=body;var cb=lib.callbacks.shift();while(cb){cb.func(lib.body(cb.arg));cb=lib.callbacks.shift();}}else{}}catch(e){}}})();if(window.gg_nol_FlashCallBack){for(var i=0,ele,len=window.gg_nol_FlashCallBack.length;i<len;i+=1){if(window.gg_nol_FlashCallBack[i].hasOwnProperty("callBack")){ele=document.getElementById(window.gg_nol_FlashCallBack[i].swfId);if(ele){ele[window.gg_nol_FlashCallBack[i].callBack]();}}}window.gg_nol_FlashCallBack=undefined;}if(!isBuilt){isBuilt=true;startGlobalTime=currentGlobalTime=Date.now();$.BUILDVERSION=BUILDVERSION;}return $;})(window.NOLCMB=window.NOLCMB||{},window);